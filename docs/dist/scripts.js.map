{"version":3,"sources":["docs/src/scripts.js","dist/client.mjs"],"names":["_typeof","obj","Symbol","iterator","constructor","prototype","t","_classCallCheck","e","TypeError","_defineProperties","n","r","length","enumerable","configurable","writable","Object","defineProperty","key","_createClass","_defineProperty","value","_slicedToArray","_arrayWithHoles","_iterableToArrayLimit","_nonIterableRest","Array","isArray","o","i","s","c","next","done","push","return","getConstructor","instanceOf","isObject","isNumber","Number","isNaN","isString","String","isBoolean","Boolean","isFunction","Function","isNullOrUndefined","isObjectId","test","isCurrencyCode","isEmpty","keys","isUrl","arguments","window","URL","concat","hostname","is","array","object","number","string","boolean","function","nullOrUndefined","objectId","currencyCode","url","empty","getBase","config","urls","product","products","categories","store","createCart","getCart","checkCarts","addToCart","updateCartItemQuantity","removeFromCart","client","ProductUrls","this","assign","ProductImage","ProductMedia","cover","ProductFile","ProductVariant","selected","id","ProductVariantAttributeOption","label","ProductVariantAttribute","options","map","Product","media","images","files","has_variants","variants","has_variant_attributes","variant_attributes","get","find","client$1","CartItem","cartId","variant_id","Cart","active","items","from","Category","Store","replaceAll","replace","RegExp","toString","toTitleCase","charAt","toUpperCase","substr","toLowerCase","toPascalCase","buildFormData","FormData","forEach","File","append","extend","shift","includes","apply","parseJSON","Promise","JSON","parse","defaults","type","body","responseType","fetch","XMLHttpRequest","Error","request","a","status","addEventListener","response","then","success","data","errors","catch","open","send","queue","http","post","dedupe","filter","indexOf","parseUrl","storage","Map","getKey","host","pathname","Storage","root","carts","stores","ttl","schema","Date","getTime","purge","supported","localStorage","getItem","set","setItem","stringify","removeItem","now","getCarts","Client","env","getStore","setStore","getStoreId","currency","discount","setCart","getCartId","getActiveCart","join","entries","setCarts","values","setActiveCart","u","index","quantity","document","log","details","createElement","summary","innerHTML","appendChild","contents","pre","classList","add","output","prettyPrint","fail","error","resolve","reject","cart","currency_code","variant","updatedCart","getElementById","getProduct"],"mappings":"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","file":"scripts.js","sourcesContent":["import Client from '../../dist/client';\n\ndocument.addEventListener('DOMContentLoaded', () => {\n    const output = document.getElementById('output');\n\n    function log(label, data) {\n        const details = document.createElement('details');\n        const summary = document.createElement('summary');\n        summary.innerHTML = label;\n        details.appendChild(summary);\n\n        const contents = document.createElement('div');\n        const pre = document.createElement('pre');\n        pre.classList.add('prettyprint');\n        pre.innerHTML = JSON.stringify(data, null, 4);\n        contents.appendChild(pre);\n        details.appendChild(contents);\n\n        output.appendChild(details);\n\n        window.prettyPrint();\n    }\n\n    function fail(label, errors) {\n        if (errors instanceof Error) {\n            // console.error(errors);\n            return log(`${label} (error)`, { error: errors.toString() });\n        }\n\n        return log(`${label} (failed)`, errors);\n    }\n\n    const client = new Client({\n        store: 'local.sampotts.me',\n        env: 'local-selz.com',\n    });\n\n    // Expose\n    window.client = client;\n\n    log('Client', client);\n\n    function getCart(currency) {\n        return new Promise((resolve, reject) => {\n            if (window.cart) {\n                resolve(window.cart);\n                return;\n            }\n\n            client\n                .getCart(currency)\n                .then(cart => {\n                    log('Get cart', cart);\n\n                    window.cart = cart;\n\n                    resolve(cart);\n                })\n                .catch(error => reject(error));\n        });\n    }\n\n    function addToCart(product) {\n        getCart(product.currency_code)\n            .then(cart => {\n                let variant = null;\n\n                if (typeof product.variant === 'string' && product.variant.length) {\n                    ({ variant } = product);\n                } else if (product.variants && product.variants.length) {\n                    variant = product.variants[0].id;\n                }\n\n                cart.add({\n                    id: product.id,\n                    quantity: 2,\n                    variant_id: variant,\n                })\n                    .then(updatedCart => {\n                        log('Add to cart', updatedCart);\n\n                        window.cart = updatedCart;\n                    })\n                    .catch(error => fail('Add to cart', error));\n            })\n            .catch(error => fail('Get cart', error));\n    }\n\n    const products = {\n        GBP: 'http://selz.co/1MaSYRU',\n        USD: 'http://selz.co/1rvbhT6',\n    };\n\n    client\n        .getProduct(products.GBP)\n        .then(product => {\n            log('Product', product);\n\n            // Expose\n            window.product = product;\n\n            addToCart(product);\n        })\n        .catch(errors => fail('Product', errors));\n\n    // Listen for messages from parent\n    /* window.addEventListener('message', event => {\n        // console.warn(event.data);\n        const json = JSON.parse(event.data);\n\n        if (json.key !== 'add-to-cart') {\n            return;\n        }\n\n        addToCart(json.data);\n    }); */\n});\n","function _typeof(t){return(_typeof=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&\"function\"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?\"symbol\":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),t}function _defineProperty(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_nonIterableRest()}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _iterableToArrayLimit(t,e){var r=[],n=!0,i=!1,o=void 0;try{for(var s,c=t[Symbol.iterator]();!(n=(s=c.next()).done)&&(r.push(s.value),!e||r.length!==e);n=!0);}catch(t){i=!0,o=t}finally{try{n||null==c.return||c.return()}finally{if(i)throw o}}return r}function _nonIterableRest(){throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")}var getConstructor=function(t){return null!=t?t.constructor:null},instanceOf=function(t,e){return!!(t&&e&&t instanceof e)},isArray=function(t){return Array.isArray(t)},isObject=function(t){return getConstructor(t)===Object},isNumber=function(t){return getConstructor(t)===Number&&!Number.isNaN(t)},isString=function(t){return getConstructor(t)===String},isBoolean=function(t){return getConstructor(t)===Boolean},isFunction=function(t){return getConstructor(t)===Function},isNullOrUndefined=function(t){return null==t},isObjectId=function(t){return isString(t)&&/^[a-f\\d]{24}$/i.test(t)},isCurrencyCode=function(t){return isString(t)&&/^[A-z]{3}$/.test(t)},isEmpty=function(t){return isNullOrUndefined(t)||(isString(t)||isArray(t))&&!t.length||isObject(t)&&!Object.keys(t).length},isUrl=function(t){var e=!!(1<arguments.length&&void 0!==arguments[1])&&arguments[1];if(instanceOf(t,window.URL))return!0;var r=t;e||/^https?:\\/\\/*/.test(t)||(r=\"http://\".concat(t));try{return!isEmpty(new URL(r).hostname)}catch(t){return!1}},is={array:isArray,object:isObject,number:isNumber,string:isString,boolean:isBoolean,function:isFunction,nullOrUndefined:isNullOrUndefined,objectId:isObjectId,currencyCode:isCurrencyCode,url:isUrl,empty:isEmpty},getBase=function(t){return\"https://\".concat(is.empty(t)?\"sdk.selz.com\":\"\".concat(t,\"/sdk\"),\"/\")},config={urls:{product:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:\"\";return\"\".concat(getBase(t),\"products/find?url=\").concat(e)},products:function(t,e){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:\"\",n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:\"\",i=4<arguments.length&&void 0!==arguments[4]?arguments[4]:1;return\"\".concat(getBase(t),\"products/all/\").concat(e,\"?q=\").concat(r,\"&c=\").concat(n,\"&p=\").concat(i)},categories:function(t,e){return\"\".concat(getBase(t),\"categories/\").concat(e)},store:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;return is.number(e)?\"\".concat(getBase(t),\"store/find/\").concat(e):\"\".concat(getBase(t),\"store/find?url=\").concat(e)},createCart:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:\"\";return\"\".concat(getBase(t),\"cart/create/\").concat(e)},getCart:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:\"\";return\"\".concat(getBase(t),\"cart/\").concat(e)},checkCarts:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:\"\";return\"\".concat(getBase(t),\"cart/verify?ids=\").concat(e)},addToCart:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:\"\";return\"\".concat(getBase(t),\"cart/add/\").concat(e)},updateCartItemQuantity:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:\"\";return\"\".concat(getBase(t),\"cart/updateitemquantity/\").concat(e)},removeFromCart:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:\"\";return\"\".concat(getBase(t),\"cart/remove/\").concat(e)}}},client=null,ProductUrls=function t(e){_classCallCheck(this,t),Object.assign(this,e)},ProductImage=function t(e){_classCallCheck(this,t),Object.assign(this,e)},ProductMedia=function t(e){_classCallCheck(this,t),Object.assign(this,e),this.cover=new ProductImage(e.cover)},ProductFile=function t(e){_classCallCheck(this,t),Object.assign(this,e)},ProductVariant=function t(e){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:\"\";_classCallCheck(this,t),Object.assign(this,e),this.selected=e.id===r},ProductVariantAttributeOption=function t(e,r){_classCallCheck(this,t),this.id=e,this.label=r},ProductVariantAttribute=function t(e){_classCallCheck(this,t),Object.assign(this,e),this.options=Object.keys(e.options).map(function(t){return new ProductVariantAttributeOption(t,e.options[t])})},Product=function(){function t(e,r){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:\"\";if(_classCallCheck(this,t),is.object(r)){if(client=e,Object.assign(this,r),this.store=client.store,is.object(r.urls)&&(this.urls=new ProductUrls(r.urls)),is.object(r.media)&&(this.media=new ProductMedia(r.media)),is.array(r.images)&&(this.images=r.images.map(function(t){return new ProductImage(t)})),is.array(r.files)&&(this.files=r.files.map(function(t){return new ProductFile(t)})),r.has_variants){var i=is.empty(n)?r.variants[0].id:n;this.variants=r.variants.map(function(t){return new ProductVariant(t,i)})}r.has_variant_attributes&&(this.variant_attributes=r.variant_attributes.map(function(t){return new ProductVariantAttribute(t)}))}}return _createClass(t,[{key:\"selected_variant\",get:function(){return is.empty(this.variants)?null:this.variants.find(function(t){return t.selected})}}]),t}(),client$1=null,CartItem=function t(e,r){_classCallCheck(this,t),this.cartId=r,Object.assign(this,e),this.product=new Product(client$1,e.product,e.variant_id)},Cart=function(){function t(e,r){var n=!!(2<arguments.length&&void 0!==arguments[2])&&arguments[2];_classCallCheck(this,t),null===r||(client$1=e,Object.assign(this,r),this.store=client$1.store,this.active=n,this.items=Array.from(r.items).map(function(t){return new CartItem(t,r.id)}))}return _createClass(t,[{key:\"add\",value:function(t){return client$1.addToCart(this.id,t)}},{key:\"remove\",value:function(t){return client$1.removeFromCart(this.id,t)}}]),t}(),Category=function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;_classCallCheck(this,t),is.object(e)&&Object.assign(this,e)},Store=function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;_classCallCheck(this,t),is.object(e)&&Object.assign(this,e)};function replaceAll(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:\"\",e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:\"\",r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:\"\";return t.replace(new RegExp(e.toString().replace(/([.*+?^=!:${}()|[\\]\\/\\\\])/g,\"\\\\$1\"),\"g\"),r.toString())}function toTitleCase(){return(0<arguments.length&&void 0!==arguments[0]?arguments[0]:\"\").toString().replace(/\\w\\S*/g,function(t){return t.charAt(0).toUpperCase()+t.substr(1).toLowerCase()})}function toPascalCase(){var t=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:\"\").toString();return t=replaceAll(t,\"-\",\" \"),t=replaceAll(t,\"_\",\" \"),replaceAll(t=toTitleCase(t),\" \",\"\")}var buildFormData=function(){var t,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=1<arguments.length?arguments[1]:void 0,n=2<arguments.length?arguments[2]:void 0,i=r||new FormData;return is.object(e)?(Object.keys(e).forEach(function(r){t=n?\"\".concat(n,\"[\").concat(r,\"]\"):r,\"object\"!==_typeof(e[r])||e[r]instanceof File?i.append(toPascalCase(t),e[r]):buildFormData(e[r],i,r)}),i):i};function extend(){for(var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length,r=Array(1<e?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];if(!r.length)return t;var i=r.shift();return is.object(i)?(Object.keys(i).forEach(function(e){is.object(i[e])?(!Object.keys(t).includes(e)&&Object.assign(t,_defineProperty({},e,{})),extend(t[e],i[e])):Object.assign(t,_defineProperty({},e,i[e]))}),extend.apply(void 0,[t].concat(r))):t}function parseJSON(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return new Promise(function(e,r){try{e(JSON.parse(t))}catch(t){r(t)}})}var defaults={type:\"GET\",body:{},responseType:\"json\"};function fetch(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=extend({},defaults,e),n=r.type,i=r.body,o=r.responseType;return new Promise(function(e,r){try{var s=new XMLHttpRequest;if(!(\"withCredentials\"in s)){var c=new Error(\"No CORS support\");throw c.request=s,c}var a=function(){var t=new Error(s.status);t.request=s,r(t)};s.addEventListener(\"load\",function(){var t=s.response;return 400<=s.status?void a():void(\"json\"===o?parseJSON(t).then(function(t){if(t.success)e(t.data);else{var n=new Error(\"Request failed\");n.errors=t.errors,r(n)}}).catch(r):e(t))}),s.addEventListener(\"error\",a),s.open(n,t,!0),\"json\"!==o&&(s.responseType=o),s.send(buildFormData(i))}catch(t){r(t)}})}var queue={},http={get:function(t){if(!Object.keys(queue).includes(t)){queue[t]=fetch(t);var e=function(){delete queue[t]};queue[t].then(e).catch(e)}return queue[t]},post:function(t){return fetch(t,{type:\"POST\",body:1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}})}};function dedupe(t){return is.array(t)?t.filter(function(e,r){return t.indexOf(e)===r}):t}function parseUrl(t){var e=t;/^https?:\\/\\/*/.test(t)||(e=\"http://\".concat(t));try{return new URL(e)}catch(t){return null}}var storage=new Map,getKey=function(t){if(null===t)return null;var e=parseUrl(t);return null===e?null:\"\".concat(e.host).concat(e.pathname).replace(/\\/$/,\"\")},Storage=function(){function t(e){_classCallCheck(this,t),this.config=Object.assign({keys:{root:\"selz-js-sdk\",carts:\"carts\",stores:\"stores\"},ttl:3600,schema:new Date(\"2018-07-02\").getTime()},e),this.purge()}return _createClass(t,[{key:\"get\",value:function(e){var r=storage.get(this.config.keys.root);if(t.supported){var n=window.localStorage.getItem(this.config.keys.root);is.empty(n)||(r=JSON.parse(n))}return is.empty(r)?null:is.empty(e)?r:Object.keys(r).includes(e)?r[e]:null}},{key:\"set\",value:function(e,r){var n=!!(2<arguments.length&&void 0!==arguments[2])&&arguments[2],i=this.get()||{};if(i[e]=n&&Object.keys(i).includes(e)?extend(i[e],r):r,storage.set(this.config.keys.root,i),t.supported){i.schema=this.config.schema;try{window.localStorage.setItem(this.config.keys.root,JSON.stringify(i))}catch(t){}}}},{key:\"purge\",value:function(){var t=this.get();if(!is.empty(t)){if(+t.schema!==this.config.schema)return void window.localStorage.removeItem(this.config.keys.root);var e=this.get(this.config.keys.stores)||[];is.empty(e)||this.set(this.config.keys.stores,e.filter(function(t){var e=+t.ttl;return 0<e&&e>Date.now()}))}}},{key:\"getCarts\",value:function(t){var e=this.get(this.config.keys.carts)||{};return is.empty(e)?null:is.number(t)?Object.keys(e).includes(t.toString())?e[t.toString()]:null:e}},{key:\"getCart\",value:function(t,e){var r=this.getCarts(t);return is.empty(r)?null:is.string(e)?Object.keys(r).includes(e.toUpperCase())?r[e.toUpperCase()]:null:r}},{key:\"setCart\",value:function(t,e,r){this.set(this.config.keys.carts,_defineProperty({},t,_defineProperty({},e.toUpperCase(),{id:r.id,active:r.active})),!0)}},{key:\"setCarts\",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};this.set(this.config.keys.carts,_defineProperty({},t,e))}},{key:\"getStore\",value:function(t){var e=null;if(!is.number(t)&&!is.url(t))return null;var r=this.get(this.config.keys.stores)||[];if(is.number(t))e=r.find(function(e){return is.object(e.data)&&e.data.id===t});else if(is.url(t)){var n=getKey(t);if(null===n)return null;e=r.find(function(t){return is.array(t.urls)&&t.urls.includes(n)})}if(!is.object(e))return null;var i=+e.ttl;return 0<i&&i<Date.now()?(this.purge(),null):new Store(e.data)}},{key:\"setStore\",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,r=getKey(e),n=this.get(this.config.keys.stores)||[],i=null;is.empty(n)||(i=n.find(function(e){return e.data.id===t.id}));var o=Date.now()+this.config.ttl;if(is.object(i)){if(Object.assign(i,{data:t,ttl:o}),null!==r){is.array(i.urls)?i.urls.push(r):i.urls=[r];var s=dedupe(i.urls);Object.assign(i,{urls:s})}}else{var c={data:t,ttl:o};null!==r&&Object.assign(c,{urls:[r]}),n.push(c)}this.set(this.config.keys.stores,n)}}],[{key:\"supported\",get:function(){if(!window.localStorage)return!1;try{return window.localStorage.setItem(\"___test\",\"___test\"),window.localStorage.removeItem(\"___test\"),!0}catch(t){return!1}}}]),t}(),Client=function(){function t(e){_classCallCheck(this,t);var r=e.env,n=e.store;if(this.env=is.empty(r)?\"\":r,this.store=n,!is.url(n)&&!is.number(n))throw Error(\"A store ID or URL is required to create a client\");this.storage=new Storage}return _createClass(t,[{key:\"getStoreId\",value:function(){var t=this;return new Promise(function(e,r){return is.number(t.store)?void e(t.store):t.store instanceof Store?void e(t.store.id):(!is.url(t.store)&&r(new Error(\"Url is required for user lookup\")),void t.getStore().then(function(t){e(t.id)}).catch(r))})}},{key:\"getStore\",value:function(){var t=this;return new Promise(function(e,r){if(is.number(t.store)||is.url(t.store)){var n=t.storage.getStore(t.store);if(null!==n&&n instanceof Store)return void e(n)}if(t.store instanceof Store)e(t.store);else{var i=config.urls.store(t.env,t.store);http.get(i).then(function(r){t.setStore(r),e(t.store)}).catch(r)}})}},{key:\"setStore\",value:function(t){if(is.object(t)){var e=is.url(this.store)?this.store:null;this.store=new Store(t),this.storage.setStore(this.store,e)}}},{key:\"getProduct\",value:function(t){var e=this;return new Promise(function(r,n){http.get(config.urls.product(e.env,t)).then(function(t){e.store instanceof Store||e.setStore(t.store),r(new Product(e,t))}).catch(n)})}},{key:\"getProducts\",value:function(){var t=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:\"\",r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:\"\",n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1;return new Promise(function(i,o){t.getStoreId().then(function(s){http.get(config.urls.products(t.env,s,is.empty(e)?\"\":e,is.objectId(r)?r:\"\",!is.number(n)||1>n?1:n)).then(function(e){i(Object.assign({},e,{products:e.products.map(function(e){return new Product(t,e)})}))}).catch(o)}).catch(o)})}},{key:\"getCategories\",value:function(){var t=this;return new Promise(function(e,r){t.getStoreId().then(function(n){http.get(config.urls.categories(t.env,n)).then(function(t){e(Object.assign({},t,{categories:t.categories.map(function(t){return new Category(t)})}))}).catch(r)}).catch(r)})}},{key:\"createCart\",value:function(t,e){var r=this;return new Promise(function(n,i){return is.empty(t)?void i(new Error(\"currency is required\")):void r.getStoreId().then(function(o){var s=t.toUpperCase();http.post(config.urls.createCart(r.env,o),{currency:s,discount:is.empty(e)?null:e}).then(function(t){var e=new Cart(r,t);r.storage.setCart(o,s,e),n(e)}).catch(i)}).catch(i)})}},{key:\"getCartId\",value:function(t){var e=this;return new Promise(function(r,n){return is.currencyCode(t)?void e.getStoreId().then(function(i){var o=t.toUpperCase(),s=e.storage.getCart(i,o);is.empty(s)?e.createCart(o).then(function(t){return r(t.id)}).catch(n):r(s.id)}).catch(n):void n(new Error(\"A valid currency code is required\"))})}},{key:\"getCart\",value:function(t){var e=this;return new Promise(function(r,n){var i=is.currencyCode(t),o=is.objectId(t);if(i||o)if(i){var s=t.toUpperCase();e.getCartId(s).then(function(t){return is.empty(t)?void n(new Error(\"Could not find matching cart for currency code '\".concat(s,\"'\"))):void e.getCart(t).then(function(t){e.setStore(t.store),r(t)}).catch(n)}).catch(n)}else http.get(config.urls.getCart(e.env,t)).then(function(t){var n=e.getActiveCart(),i=new Cart(e,t,t.id===n);e.setStore(i.store),r(i)}).catch(n);else n(new Error(\"A valid currency code or cart id are required\"))})}},{key:\"getCarts\",value:function(){var t=this,e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];return new Promise(function(r,n){t.getStoreId().then(function(i){var o=t.storage.getCarts(i);if(is.empty(o))r(null);else if(e){var s=Object.keys(o).map(function(t){return o[t].id});http.get(config.urls.checkCarts(t.env,s.join(\",\"))).then(function(e){Object.entries(e).forEach(function(t){var e=_slicedToArray(t,2),r=e[0];if(!e[1]){var n=Object.keys(o).find(function(t){return o[t].id===r});delete o[n]}}),t.storage.setCarts(i,o),Object.values(o).find(function(t){return t.active})?r(o):t.setActiveCart().then(r).catch(n)}).catch(n)}else r(o)}).catch(n)})}},{key:\"setActiveCart\",value:function(){var t=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;return new Promise(function(r,n){t.getStoreId().then(function(i){t.getCarts(!1).then(function(o){var s=o;if(is.empty(s))r(null);else{if(is.currencyCode(e)){var c=e.toUpperCase(),a=Object.keys(s);if(!a.includes(c))return void n(new Error(\"No carts for \".concat(c)));a.forEach(function(t){s[t].active=t===c})}else{var u=is.objectId(e)?e:s[Object.keys(s)[0]].id;Object.keys(s).forEach(function(t){var e=s[t];e.active=e.id===u})}t.storage.setCarts(i,s),r(s)}})}).catch(n)})}},{key:\"getActiveCart\",value:function(){var t=this,e=!!(0<arguments.length&&void 0!==arguments[0])&&arguments[0];return new Promise(function(r,n){t.getStoreId().then(function(i){var o=t.storage.getCarts(i);if(Object.keys(o).length){var s=Object.values(o).find(function(t){return t.active});return s?e?void t.getCart(s.id).then(r).catch(n):void r(s.id):void r(null)}r(null)}).catch(n)})}},{key:\"addToCart\",value:function(t,e){var r=this;return new Promise(function(n,i){return is.objectId(t)?is.empty(e)?void i(new Error(\"A valid product is required\")):void http.post(config.urls.addToCart(r.env,t),e).then(function(t){var e=new Cart(r,t,!0);r.setStore(e.store),r.setActiveCart(e.id).then(function(){n(e)}).catch(i)}).catch(i):void i(new Error(\"A valid id is required\"))})}},{key:\"updateCartItemQuantity\",value:function(t,e){var r=this,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1;return new Promise(function(i,o){return is.objectId(t)?is.empty(e)?void o(new Error(\"A valid index is required\")):void http.post(config.urls.updateCartItemQuantity(r.env,t),{index:e,quantity:n}).then(function(t){var e=new Cart(r,t,!0);r.setStore(e.store),r.setActiveCart(e.id).then(function(){i(e)}).catch(o)}).catch(o):void o(new Error(\"A valid id is required\"))})}},{key:\"removeFromCart\",value:function(t,e){var r=this;return new Promise(function(n,i){return is.objectId(t)?is.empty(e)?void i(new Error(\"A valid index is required\")):void http.post(config.urls.removeFromCart(r.env,t),{index:e}).then(function(t){if(is.empty(t))r.getCarts().then(function(){return n(null)}).catch(i);else{var e=new Cart(r,t,!0);r.setActiveCart(e.id).then(function(){n(e)}).catch(i)}}).catch(i):void i(new Error(\"A valid id is required\"))})}}]),t}();export default Client;export{Product,Category,Cart,CartItem,Store};"]}