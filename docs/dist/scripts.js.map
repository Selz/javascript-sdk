{"version":3,"sources":["docs/src/scripts.js","dist/client.mjs"],"names":["_typeof","obj","Symbol","iterator","constructor","prototype","t","_classCallCheck","e","TypeError","_defineProperties","n","r","length","enumerable","configurable","writable","Object","defineProperty","key","_createClass","_defineProperty","value","_slicedToArray","_arrayWithHoles","_iterableToArrayLimit","_nonIterableRest","Array","isArray","o","i","s","c","next","done","push","return","getConstructor","instanceOf","isObject","isNumber","Number","isNaN","isString","String","isBoolean","Boolean","isFunction","Function","isNullOrUndefined","isObjectId","test","isCurrencyCode","isEmpty","keys","isUrl","arguments","window","URL","concat","hostname","is","array","object","number","string","boolean","function","nullOrUndefined","objectId","currencyCode","product","isProduct","cart","isCart","category","isCategory","url","empty","getBase","config","urls","products","categories","store","createCart","getCart","checkCarts","addToCart","updateCartItemQuantity","removeFromCart","client","ProductUrls","this","assign","ProductImage","ProductMedia","cover","ProductFile","ProductVariant","selected","id","ProductVariantAttributeOption","label","ProductVariantAttribute","options","map","Product","media","images","files","has_variants","variants","has_variant_attributes","variant_attributes","get","find","client$1","CartItem","cartId","variant_id","Cart","active","items","from","Category","Store","replaceAll","replace","RegExp","toString","toTitleCase","charAt","toUpperCase","substr","toLowerCase","toPascalCase","buildFormData","FormData","forEach","File","append","extend","shift","includes","apply","parseJSON","Promise","JSON","parse","defaults","type","body","responseType","fetch","XMLHttpRequest","Error","request","a","status","addEventListener","response","then","success","data","errors","catch","open","send","queue","http","post","dedupe","filter","indexOf","parseUrl","storage","Map","getKey","host","pathname","Storage","root","carts","stores","ttl","schema","Date","getTime","purge","supported","localStorage","getItem","set","setItem","stringify","removeItem","now","getCarts","Client","env","getStore","setStore","getStoreId","currency","discount","setCart","getCartId","getActiveCart","join","entries","setCarts","values","setActiveCart","u","index","quantity","document","log","details","createElement","summary","innerHTML","appendChild","contents","pre","classList","add","output","prettyPrint","fail","error","resolve","reject","currency_code","variant","updatedCart","getElementById","getProduct"],"mappings":"AAAA,SAASA,QAAQC,GAWf,OATED,QADoB,mBAAXE,QAAoD,iBAApBA,OAAOC,SACtC,SAAUF,GAClB,cAAcA,GAGN,SAAUA,GAClB,OAAOA,GAAyB,mBAAXC,QAAyBD,EAAIG,cAAgBF,QAAUD,IAAQC,OAAOG,UAAY,gBAAkBJ,IAI9GA,GCXjB,SAASD,UAAQM,GAAG,OAAON,UAAQ,mBAAmBE,QAAQ,UAAAF,QAAiBE,OAAOC,UAAS,SAASG,GAAG,OAAAN,QAAcM,IAAG,SAASA,GAAG,OAAOA,GAAG,mBAAmBJ,QAAQI,EAAEF,cAAcF,QAAQI,IAAIJ,OAAOG,UAAU,SAA3EL,QAA2FM,KAAIA,GAAG,SAASC,kBAAgBD,EAAEE,GAAG,KAAKF,aAAaE,GAAG,MAAA,IAAUC,UAAU,qCAAqC,SAASC,oBAAkBJ,EAAEE,GAAG,IAAI,IAA4BG,EAAxBC,EAAE,EAAEA,EAAEJ,EAAEK,OAAOD,KAASD,EAAEH,EAAEI,IAAKE,WAAWH,EAAEG,aAAY,EAAGH,EAAEI,cAAa,EAAG,UAAUJ,IAAIA,EAAEK,UAAS,GAAIC,OAAOC,eAAeZ,EAAEK,EAAEQ,IAAIR,GAAI,SAASS,eAAad,EAAEE,EAAEI,GAAG,OAAOJ,GAAGE,oBAAkBJ,EAAED,UAAUG,GAAGI,GAAGF,oBAAkBJ,EAAEM,GAAGN,EAAE,SAASe,kBAAgBf,EAAEE,EAAEI,GAAG,OAAOJ,KAAKF,EAAEW,OAAOC,eAAeZ,EAAEE,EAAE,CAACc,MAAMV,EAAEE,YAAW,EAAGC,cAAa,EAAGC,UAAS,IAAKV,EAAEE,GAAGI,EAAEN,EAAE,SAASiB,iBAAejB,EAAEE,GAAG,OAAOgB,kBAAgBlB,IAAImB,wBAAsBnB,EAAEE,IAAIkB,qBAAmB,SAASF,kBAAgBlB,GAAG,GAAGqB,MAAMC,QAAQtB,GAAG,OAAOA,EAAE,SAASmB,wBAAsBnB,EAAEE,GAAG,IAAmBqB,EAAfjB,EAAE,GAAGD,GAAE,EAAGmB,GAAE,EAAY,IAAI,IAAI,IAAIC,EAAEC,EAAE1B,EAAEJ,OAAOC,cAAcQ,GAAGoB,EAAEC,EAAEC,QAAQC,QAAQtB,EAAEuB,KAAKJ,EAAET,QAAQd,GAAGI,EAAEC,SAASL,GAAGG,GAAE,IAAK,MAAML,GAAGwB,GAAE,EAAGD,EAAEvB,EAAvH,QAAiI,IAAIK,GAAG,MAAMqB,EAAEI,QAAQJ,EAAEI,SAAzB,QAA0C,GAAGN,EAAE,MAAMD,GAAG,OAAOjB,EAAE,SAASc,qBAAmB,MAAA,IAAUjB,UAAU,wDAAwD,IAAI4B,eAAe,SAAS/B,GAAG,OAAA,MAAaA,EAAgB,KAAdA,EAAEF,aAAkBkC,WAAW,SAAShC,EAAEE,GAAG,SAASF,GAAGE,GAAGF,aAAaE,IAAIoB,QAAQ,SAAStB,GAAG,OAAOqB,MAAMC,QAAQtB,IAAIiC,SAAS,SAASjC,GAAG,OAAO+B,eAAe/B,KAAKW,QAAQuB,SAAS,SAASlC,GAAG,OAAO+B,eAAe/B,KAAKmC,SAASA,OAAOC,MAAMpC,IAAIqC,SAAS,SAASrC,GAAG,OAAO+B,eAAe/B,KAAKsC,QAAQC,UAAU,SAASvC,GAAG,OAAO+B,eAAe/B,KAAKwC,SAASC,WAAW,SAASzC,GAAG,OAAO+B,eAAe/B,KAAK0C,UAAUC,kBAAkB,SAAS3C,GAAG,OAAA,MAAaA,GAAG4C,WAAW,SAAS5C,GAAG,OAAOqC,SAASrC,IAAI,iBAAiB6C,KAAK7C,IAAI8C,eAAe,SAAS9C,GAAG,OAAOqC,SAASrC,IAAI,aAAa6C,KAAK7C,IAAI+C,QAAQ,SAAS/C,GAAG,OAAO2C,kBAAkB3C,KAAKqC,SAASrC,IAAIsB,QAAQtB,MAAMA,EAAEO,QAAQ0B,SAASjC,KAAKW,OAAOqC,KAAKhD,GAAGO,QAAQ0C,MAAM,SAASjD,GAAG,IAAIE,KAAK,EAAEgD,UAAU3C,aAAQ,IAAS2C,UAAU,KAAKA,UAAU,GAAG,GAAGlB,WAAWhC,EAAEmD,OAAOC,KAAK,OAAM,EAAG,IAAI9C,EAAEN,EAAEE,GAAG,gBAAgB2C,KAAK7C,KAAKM,EAAE,UAAU+C,OAAOrD,IAAI,IAAI,OAAO+C,QAAQ,IAAIK,IAAI9C,GAAGgD,UAAU,MAAMtD,GAAG,OAAM,IAAKuD,GAAG,CAACC,MAAMlC,QAAQmC,OAAOxB,SAASyB,OAAOxB,SAASyB,OAAOtB,SAASuB,QAAQrB,UAAUsB,SAASpB,WAAWqB,gBAAgBnB,kBAAkBoB,SAASnB,WAAWoB,aAAalB,eAAemB,QAAQC,UAAUC,KAAKC,OAAOC,SAASC,WAAWC,IAAItB,MAAMuB,MAAMzB,SAAS0B,QAAQ,SAASzE,GAAG,MAAM,WAAWqD,OAAOE,GAAGiB,MAAMxE,GAAG,eAAe,GAAGqD,OAAOrD,EAAE,QAAQ,MAAM0E,OAAO,CAACC,KAAK,CAACV,QAAQ,SAASjE,GAAG,IAAIE,EAAE,EAAEgD,UAAU3C,aAAQ,IAAS2C,UAAU,GAAGA,UAAU,GAAG,GAAG,MAAM,GAAGG,OAAOoB,QAAQzE,GAAG,sBAAsBqD,OAAOnD,IAAI0E,SAAS,SAAS5E,EAAEE,GAAG,IAAII,EAAE,EAAE4C,UAAU3C,aAAQ,IAAS2C,UAAU,GAAGA,UAAU,GAAG,GAAG7C,EAAE,EAAE6C,UAAU3C,aAAQ,IAAS2C,UAAU,GAAGA,UAAU,GAAG,GAAG1B,EAAE,EAAE0B,UAAU3C,aAAQ,IAAS2C,UAAU,GAAGA,UAAU,GAAG,EAAE,MAAM,GAAGG,OAAOoB,QAAQzE,GAAG,iBAAiBqD,OAAOnD,EAAE,OAAOmD,OAAO/C,EAAE,OAAO+C,OAAOhD,EAAE,OAAOgD,OAAO7B,IAAIqD,WAAW,SAAS7E,EAAEE,GAAG,MAAM,GAAGmD,OAAOoB,QAAQzE,GAAG,eAAeqD,OAAOnD,IAAI4E,MAAM,SAAS9E,GAAG,IAAIE,EAAE,EAAEgD,UAAU3C,aAAQ,IAAS2C,UAAU,GAAGA,UAAU,GAAG,KAAK,OAAOK,GAAGG,OAAOxD,GAAG,GAAGmD,OAAOoB,QAAQzE,GAAG,eAAeqD,OAAOnD,GAAG,GAAGmD,OAAOoB,QAAQzE,GAAG,mBAAmBqD,OAAOnD,IAAI6E,WAAW,SAAS/E,GAAG,IAAIE,EAAE,EAAEgD,UAAU3C,aAAQ,IAAS2C,UAAU,GAAGA,UAAU,GAAG,GAAG,MAAM,GAAGG,OAAOoB,QAAQzE,GAAG,gBAAgBqD,OAAOnD,IAAI8E,QAAQ,SAAShF,GAAG,IAAIE,EAAE,EAAEgD,UAAU3C,aAAQ,IAAS2C,UAAU,GAAGA,UAAU,GAAG,GAAG,MAAM,GAAGG,OAAOoB,QAAQzE,GAAG,SAASqD,OAAOnD,IAAI+E,WAAW,SAASjF,GAAG,IAAIE,EAAE,EAAEgD,UAAU3C,aAAQ,IAAS2C,UAAU,GAAGA,UAAU,GAAG,GAAG,MAAM,GAAGG,OAAOoB,QAAQzE,GAAG,oBAAoBqD,OAAOnD,IAAIgF,UAAU,SAASlF,GAAG,IAAIE,EAAE,EAAEgD,UAAU3C,aAAQ,IAAS2C,UAAU,GAAGA,UAAU,GAAG,GAAG,MAAM,GAAGG,OAAOoB,QAAQzE,GAAG,aAAaqD,OAAOnD,IAAIiF,uBAAuB,SAASnF,GAAG,IAAIE,EAAE,EAAEgD,UAAU3C,aAAQ,IAAS2C,UAAU,GAAGA,UAAU,GAAG,GAAG,MAAM,GAAGG,OAAOoB,QAAQzE,GAAG,4BAA4BqD,OAAOnD,IAAIkF,eAAe,SAASpF,GAAG,IAAIE,EAAE,EAAEgD,UAAU3C,aAAQ,IAAS2C,UAAU,GAAGA,UAAU,GAAG,GAAG,MAAM,GAAGG,OAAOoB,QAAQzE,GAAG,gBAAgBqD,OAAOnD,MAAMmF,OAAO,KAAKC,YAAY,SAAStF,EAAEE,GAAGD,kBAAgBsF,KAAKvF,GAAGW,OAAO6E,OAAOD,KAAKrF,IAAIuF,aAAa,SAASzF,EAAEE,GAAGD,kBAAgBsF,KAAKvF,GAAGW,OAAO6E,OAAOD,KAAKrF,IAAIwF,aAAa,SAAS1F,EAAEE,GAAGD,kBAAgBsF,KAAKvF,GAAGW,OAAO6E,OAAOD,KAAKrF,GAAGqF,KAAKI,MAAM,IAAIF,aAAavF,EAAEyF,QAAQC,YAAY,SAAS5F,EAAEE,GAAGD,kBAAgBsF,KAAKvF,GAAGW,OAAO6E,OAAOD,KAAKrF,IAAI2F,eAAe,SAAS7F,EAAEE,GAAG,IAAII,EAAE,EAAE4C,UAAU3C,aAAQ,IAAS2C,UAAU,GAAGA,UAAU,GAAG,GAAGjD,kBAAgBsF,KAAKvF,GAAGW,OAAO6E,OAAOD,KAAKrF,GAAGqF,KAAKO,SAAS5F,EAAE6F,KAAKzF,GAAG0F,8BAA8B,SAAShG,EAAEE,EAAEI,GAAGL,kBAAgBsF,KAAKvF,GAAGuF,KAAKQ,GAAG7F,EAAEqF,KAAKU,MAAM3F,GAAG4F,wBAAwB,SAASlG,EAAEE,GAAGD,kBAAgBsF,KAAKvF,GAAGW,OAAO6E,OAAOD,KAAKrF,GAAGqF,KAAKY,QAAQxF,OAAOqC,KAAK9C,EAAEiG,SAASC,IAAI,SAASpG,GAAG,OAAA,IAAWgG,8BAA8BhG,EAAEE,EAAEiG,QAAQnG,OAAOqG,QAAQ,WAAW,SAASrG,EAAEE,EAAEI,GAAG,IAAID,EAAE,EAAE6C,UAAU3C,aAAQ,IAAS2C,UAAU,GAAGA,UAAU,GAAG,GAAG,GAAGjD,kBAAgBsF,KAAKvF,GAAGuD,GAAGE,OAAOnD,GAAG,CAAC,GAAG+E,OAAOnF,EAAES,OAAO6E,OAAOD,KAAKjF,GAAGiF,KAAKT,MAAMO,OAAOP,MAAMvB,GAAGE,OAAOnD,EAAEqE,QAAQY,KAAKZ,KAAK,IAAIW,YAAYhF,EAAEqE,OAAOpB,GAAGE,OAAOnD,EAAEgG,SAASf,KAAKe,MAAM,IAAIZ,aAAapF,EAAEgG,QAAQ/C,GAAGC,MAAMlD,EAAEiG,UAAUhB,KAAKgB,OAAOjG,EAAEiG,OAAOH,IAAI,SAASpG,GAAG,OAAA,IAAWyF,aAAazF,MAAMuD,GAAGC,MAAMlD,EAAEkG,SAASjB,KAAKiB,MAAMlG,EAAEkG,MAAMJ,IAAI,SAASpG,GAAG,OAAA,IAAW4F,YAAY5F,MAAMM,EAAEmG,aAAa,CAAC,IAAIjF,EAAE+B,GAAGiB,MAAMnE,GAAGC,EAAEoG,SAAS,GAAGX,GAAG1F,EAAEkF,KAAKmB,SAASpG,EAAEoG,SAASN,IAAI,SAASpG,GAAG,OAAA,IAAW6F,eAAe7F,EAAEwB,KAAKlB,EAAEqG,yBAAyBpB,KAAKqB,mBAAmBtG,EAAEsG,mBAAmBR,IAAI,SAASpG,GAAG,OAAA,IAAWkG,wBAAwBlG,OAAO,OAAOc,eAAad,EAAE,CAAC,CAACa,IAAI,mBAAmBgG,IAAI,WAAW,OAAOtD,GAAGiB,MAAMe,KAAKmB,UAAU,KAAKnB,KAAKmB,SAASI,KAAK,SAAS9G,GAAG,OAAOA,EAAE8F,eAAe9F,EAAt3B,GAA23B+G,SAAS,KAAKC,SAAS,SAAShH,EAAEE,EAAEI,GAAGL,kBAAgBsF,KAAKvF,GAAGuF,KAAK0B,OAAO3G,EAAEK,OAAO6E,OAAOD,KAAKrF,GAAGqF,KAAKtB,QAAQ,IAAIoC,QAAQU,SAAS7G,EAAE+D,QAAQ/D,EAAEgH,aAAaC,KAAK,WAAW,SAASnH,EAAEE,EAAEI,GAAG,IAAID,KAAK,EAAE6C,UAAU3C,aAAQ,IAAS2C,UAAU,KAAKA,UAAU,GAAGjD,kBAAgBsF,KAAKvF,GAAG,OAAOM,IAAIyG,SAAS7G,EAAES,OAAO6E,OAAOD,KAAKjF,GAAGiF,KAAKT,MAAMiC,SAASjC,MAAMS,KAAK6B,OAAO/G,EAAEkF,KAAK8B,MAAMhG,MAAMiG,KAAKhH,EAAE+G,OAAOjB,IAAI,SAASpG,GAAG,OAAA,IAAWgH,SAAShH,EAAEM,EAAEyF,OAAO,OAAOjF,eAAad,EAAE,CAAC,CAACa,IAAI,MAAMG,MAAM,SAAShB,GAAG,OAAO+G,SAAS7B,UAAUK,KAAKQ,GAAG/F,KAAK,CAACa,IAAI,SAASG,MAAM,SAAShB,GAAG,OAAO+G,SAAS3B,eAAeG,KAAKQ,GAAG/F,OAAOA,EAAhc,GAAqcuH,SAAS,SAASvH,IAAI,IAAIE,EAAE,EAAEgD,UAAU3C,aAAQ,IAAS2C,UAAU,GAAGA,UAAU,GAAG,KAAKjD,kBAAgBsF,KAAKvF,GAAGuD,GAAGE,OAAOvD,IAAIS,OAAO6E,OAAOD,KAAKrF,IAAIsH,MAAM,SAASxH,IAAI,IAAIE,EAAE,EAAEgD,UAAU3C,aAAQ,IAAS2C,UAAU,GAAGA,UAAU,GAAG,KAAKjD,kBAAgBsF,KAAKvF,GAAGuD,GAAGE,OAAOvD,IAAIS,OAAO6E,OAAOD,KAAKrF,IAAI,SAASuH,aAAa,IAAIzH,EAAE,EAAEkD,UAAU3C,aAAQ,IAAS2C,UAAU,GAAGA,UAAU,GAAG,GAAGhD,EAAE,EAAEgD,UAAU3C,aAAQ,IAAS2C,UAAU,GAAGA,UAAU,GAAG,GAAG5C,EAAE,EAAE4C,UAAU3C,aAAQ,IAAS2C,UAAU,GAAGA,UAAU,GAAG,GAAG,OAAOlD,EAAE0H,QAAQ,IAAIC,OAAOzH,EAAE0H,WAAWF,QAAQ,6BAA6B,QAAQ,KAAKpH,EAAEsH,YAAY,SAASC,cAAc,OAAO,EAAE3E,UAAU3C,aAAQ,IAAS2C,UAAU,GAAGA,UAAU,GAAG,IAAI0E,WAAWF,QAAQ,SAAS,SAAS1H,GAAG,OAAOA,EAAE8H,OAAO,GAAGC,cAAc/H,EAAEgI,OAAO,GAAGC,gBAAgB,SAASC,eAAe,IAAIlI,GAAG,EAAEkD,UAAU3C,aAAQ,IAAS2C,UAAU,GAAGA,UAAU,GAAG,IAAI0E,WAAW,OAAO5H,EAAEyH,WAAWzH,EAAE,IAAI,KAAKA,EAAEyH,WAAWzH,EAAE,IAAI,KAAKyH,WAAWzH,EAAE6H,YAAY7H,GAAG,IAAI,IAAI,IAAImI,cAAc,WAAW,IAAInI,EAAEE,EAAE,EAAEgD,UAAU3C,aAAQ,IAAS2C,UAAU,GAAGA,UAAU,GAAG,GAAG5C,EAAE,EAAE4C,UAAU3C,OAAO2C,UAAU,QAAG,EAAO7C,EAAE,EAAE6C,UAAU3C,OAAO2C,UAAU,QAAG,EAAO1B,EAAElB,GAAG,IAAI8H,SAAS,OAAO7E,GAAGE,OAAOvD,IAAIS,OAAOqC,KAAK9C,GAAGmI,QAAQ,SAAS/H,GAAGN,EAAEK,EAAE,GAAGgD,OAAOhD,EAAE,KAAKgD,OAAO/C,EAAE,KAAKA,EAAE,WAAWZ,UAAQQ,EAAEI,KAAKJ,EAAEI,aAAagI,KAAK9G,EAAE+G,OAAOL,aAAalI,GAAGE,EAAEI,IAAI6H,cAAcjI,EAAEI,GAAGkB,EAAElB,KAAKkB,GAAGA,GAAG,SAASgH,SAAS,IAAI,IAAIxI,EAAE,EAAEkD,UAAU3C,aAAQ,IAAS2C,UAAU,GAAGA,UAAU,GAAG,GAAGhD,EAAEgD,UAAU3C,OAAOD,EAAEe,MAAM,EAAEnB,EAAEA,EAAE,EAAE,GAAGG,EAAE,EAAEA,EAAEH,EAAEG,IAAIC,EAAED,EAAE,GAAG6C,UAAU7C,GAAG,IAAIC,EAAEC,OAAO,OAAOP,EAAE,IAAIwB,EAAElB,EAAEmI,QAAQ,OAAOlF,GAAGE,OAAOjC,IAAIb,OAAOqC,KAAKxB,GAAG6G,QAAQ,SAASnI,GAAGqD,GAAGE,OAAOjC,EAAEtB,MAAMS,OAAOqC,KAAKhD,GAAG0I,SAASxI,IAAIS,OAAO6E,OAAOxF,EAAEe,kBAAgB,GAAGb,EAAE,KAAKsI,OAAOxI,EAAEE,GAAGsB,EAAEtB,KAAKS,OAAO6E,OAAOxF,EAAEe,kBAAgB,GAAGb,EAAEsB,EAAEtB,OAAOsI,OAAOG,WAAM,EAAO,CAAC3I,GAAGqD,OAAO/C,KAAKN,EAAE,SAAS4I,YAAY,IAAI5I,EAAE,EAAEkD,UAAU3C,aAAQ,IAAS2C,UAAU,GAAGA,UAAU,GAAG,GAAG,OAAA,IAAW2F,QAAQ,SAAS3I,EAAEI,GAAG,IAAIJ,EAAE4I,KAAKC,MAAM/I,IAAI,MAAMA,GAAGM,EAAEN,MAAM,IAAIgJ,SAAS,CAACC,KAAK,MAAMC,KAAK,GAAGC,aAAa,QAAQ,SAASC,MAAMpJ,GAAG,IAAIE,EAAE,EAAEgD,UAAU3C,aAAQ,IAAS2C,UAAU,GAAGA,UAAU,GAAG,GAAG5C,EAAEkI,OAAO,GAAGQ,SAAS9I,GAAGG,EAAEC,EAAE2I,KAAKzH,EAAElB,EAAE4I,KAAK3H,EAAEjB,EAAE6I,aAAa,OAAA,IAAWN,QAAQ,SAAS3I,EAAEI,GAAG,IAAI,IAAImB,EAAE,IAAI4H,eAAe,KAAK,oBAAoB5H,GAAG,CAAC,IAAIC,EAAE,IAAI4H,MAAM,mBAAmB,MAAM5H,EAAE6H,QAAQ9H,EAAEC,EAAE,IAAI8H,EAAE,WAAW,IAAIxJ,EAAE,IAAIsJ,MAAM7H,EAAEgI,QAAQzJ,EAAEuJ,QAAQ9H,EAAEnB,EAAEN,IAAIyB,EAAEiI,iBAAiB,OAAO,WAAW,IAAI1J,EAAEyB,EAAEkI,SAAS,OAAA,KAAYlI,EAAEgI,YAAYD,SAAS,SAASjI,EAAEqH,UAAU5I,GAAG4J,KAAK,SAAS5J,GAAG,GAAGA,EAAE6J,QAAQ3J,EAAEF,EAAE8J,UAAU,CAAC,IAAIzJ,EAAE,IAAIiJ,MAAM,kBAAkBjJ,EAAE0J,OAAO/J,EAAE+J,OAAOzJ,EAAED,MAAM2J,MAAM1J,GAAGJ,EAAEF,MAAMyB,EAAEiI,iBAAiB,QAAQF,GAAG/H,EAAEwI,KAAK5J,EAAEL,GAAE,GAAI,SAASuB,IAAIE,EAAE0H,aAAa5H,GAAGE,EAAEyI,KAAK/B,cAAc3G,IAAI,MAAMxB,GAAGM,EAAEN,MAAM,IAAImK,MAAM,GAAGC,KAAK,CAACvD,IAAI,SAAS7G,GAAG,IAAIW,OAAOqC,KAAKmH,OAAOzB,SAAS1I,GAAG,CAACmK,MAAMnK,GAAGoJ,MAAMpJ,GAAG,IAAIE,EAAE,kBAAkBiK,MAAMnK,IAAImK,MAAMnK,GAAG4J,KAAK1J,GAAG8J,MAAM9J,GAAG,OAAOiK,MAAMnK,IAAIqK,KAAK,SAASrK,GAAG,OAAOoJ,MAAMpJ,EAAE,CAACiJ,KAAK,OAAOC,KAAK,EAAEhG,UAAU3C,aAAQ,IAAS2C,UAAU,GAAGA,UAAU,GAAG,OAAO,SAASoH,OAAOtK,GAAG,OAAOuD,GAAGC,MAAMxD,GAAGA,EAAEuK,OAAO,SAASrK,EAAEI,GAAG,OAAON,EAAEwK,QAAQtK,KAAKI,IAAIN,EAAE,SAASyK,SAASzK,GAAG,IAAIE,EAAEF,EAAE,gBAAgB6C,KAAK7C,KAAKE,EAAE,UAAUmD,OAAOrD,IAAI,IAAI,OAAA,IAAWoD,IAAIlD,GAAG,MAAMF,GAAG,OAAA,MAAa,IAAI0K,QAAQ,IAAIC,IAAIC,OAAO,SAAS5K,GAAG,GAAG,OAAOA,EAAE,OAAA,KAAY,IAAIE,EAAEuK,SAASzK,GAAG,OAAA,OAAcE,EAAE,KAAK,GAAGmD,OAAOnD,EAAE2K,MAAMxH,OAAOnD,EAAE4K,UAAUpD,QAAQ,MAAM,KAAKqD,QAAQ,WAAW,SAAS/K,EAAEE,GAAGD,kBAAgBsF,KAAKvF,GAAGuF,KAAKb,OAAO/D,OAAO6E,OAAO,CAACxC,KAAK,CAACgI,KAAK,cAAcC,MAAM,QAAQC,OAAO,UAAUC,IAAI,KAAKC,OAAO,IAAIC,KAAK,cAAcC,WAAWpL,GAAGqF,KAAKgG,QAAQ,OAAOzK,eAAad,EAAE,CAAC,CAACa,IAAI,MAAMG,MAAM,SAASd,GAAG,IAAII,EAAEoK,QAAQ7D,IAAItB,KAAKb,OAAO1B,KAAKgI,MAAM,GAAGhL,EAAEwL,UAAU,CAAC,IAAInL,EAAE8C,OAAOsI,aAAaC,QAAQnG,KAAKb,OAAO1B,KAAKgI,MAAMzH,GAAGiB,MAAMnE,KAAKC,EAAEwI,KAAKC,MAAM1I,IAAI,OAAOkD,GAAGiB,MAAMlE,GAAG,KAAKiD,GAAGiB,MAAMtE,GAAGI,EAAEK,OAAOqC,KAAK1C,GAAGoI,SAASxI,GAAGI,EAAEJ,GAAG,OAAO,CAACW,IAAI,MAAMG,MAAM,SAASd,EAAEI,GAAG,IAAID,KAAK,EAAE6C,UAAU3C,aAAQ,IAAS2C,UAAU,KAAKA,UAAU,GAAG1B,EAAE+D,KAAKsB,OAAO,GAAG,GAAGrF,EAAEtB,GAAGG,GAAGM,OAAOqC,KAAKxB,GAAGkH,SAASxI,GAAGsI,OAAOhH,EAAEtB,GAAGI,GAAGA,EAAEoK,QAAQiB,IAAIpG,KAAKb,OAAO1B,KAAKgI,KAAKxJ,GAAGxB,EAAEwL,UAAU,CAAChK,EAAE4J,OAAO7F,KAAKb,OAAO0G,OAAO,IAAIjI,OAAOsI,aAAaG,QAAQrG,KAAKb,OAAO1B,KAAKgI,KAAKlC,KAAK+C,UAAUrK,IAAI,MAAMxB,QAAQ,CAACa,IAAI,QAAQG,MAAM,WAAW,IAAIhB,EAAEuF,KAAKsB,MAAM,IAAItD,GAAGiB,MAAMxE,GAAG,CAAC,IAAIA,EAAEoL,SAAS7F,KAAKb,OAAO0G,OAAO,YAAYjI,OAAOsI,aAAaK,WAAWvG,KAAKb,OAAO1B,KAAKgI,MAAM,IAAI9K,EAAEqF,KAAKsB,IAAItB,KAAKb,OAAO1B,KAAKkI,SAAS,GAAG3H,GAAGiB,MAAMtE,IAAIqF,KAAKoG,IAAIpG,KAAKb,OAAO1B,KAAKkI,OAAOhL,EAAEqK,OAAO,SAASvK,GAAG,IAAIE,GAAGF,EAAEmL,IAAI,OAAA,EAASjL,GAAGA,EAAEmL,KAAKU,YAAY,CAAClL,IAAI,WAAWG,MAAM,SAAShB,GAAG,IAAIE,EAAEqF,KAAKsB,IAAItB,KAAKb,OAAO1B,KAAKiI,QAAQ,GAAG,OAAO1H,GAAGiB,MAAMtE,GAAG,KAAKqD,GAAGG,OAAO1D,GAAGW,OAAOqC,KAAK9C,GAAGwI,SAAS1I,EAAE4H,YAAY1H,EAAEF,EAAE4H,YAAY,KAAK1H,IAAI,CAACW,IAAI,UAAUG,MAAM,SAAShB,EAAEE,GAAG,IAAII,EAAEiF,KAAKyG,SAAShM,GAAG,OAAOuD,GAAGiB,MAAMlE,GAAG,KAAKiD,GAAGI,OAAOzD,GAAGS,OAAOqC,KAAK1C,GAAGoI,SAASxI,EAAE6H,eAAezH,EAAEJ,EAAE6H,eAAe,KAAKzH,IAAI,CAACO,IAAI,UAAUG,MAAM,SAAShB,EAAEE,EAAEI,GAAGiF,KAAKoG,IAAIpG,KAAKb,OAAO1B,KAAKiI,MAAMlK,kBAAgB,GAAGf,EAAEe,kBAAgB,GAAGb,EAAE6H,cAAc,CAAChC,GAAGzF,EAAEyF,GAAGqB,OAAO9G,EAAE8G,WAAU,KAAM,CAACvG,IAAI,WAAWG,MAAM,SAAShB,GAAG,IAAIE,EAAE,EAAEgD,UAAU3C,aAAQ,IAAS2C,UAAU,GAAGA,UAAU,GAAG,GAAGqC,KAAKoG,IAAIpG,KAAKb,OAAO1B,KAAKiI,MAAMlK,kBAAgB,GAAGf,EAAEE,MAAM,CAACW,IAAI,WAAWG,MAAM,SAAShB,GAAG,IAAIE,EAAE,KAAK,IAAIqD,GAAGG,OAAO1D,KAAKuD,GAAGgB,IAAIvE,GAAG,OAAA,KAAY,IAAIM,EAAEiF,KAAKsB,IAAItB,KAAKb,OAAO1B,KAAKkI,SAAS,GAAG,GAAG3H,GAAGG,OAAO1D,GAAGE,EAAEI,EAAEwG,KAAK,SAAS5G,GAAG,OAAOqD,GAAGE,OAAOvD,EAAE4J,OAAO5J,EAAE4J,KAAK/D,KAAK/F,SAA3E,GAAuFuD,GAAGgB,IAAIvE,GAAG,CAAC,IAAIK,EAAEuK,OAAO5K,GAAG,GAAG,OAAOK,EAAE,OAAA,KAAYH,EAAEI,EAAEwG,KAAK,SAAS9G,GAAG,OAAOuD,GAAGC,MAAMxD,EAAE2E,OAAO3E,EAAE2E,KAAK+D,SAASrI,KAAK,IAAIkD,GAAGE,OAAOvD,GAAG,OAAA,KAAY,IAAIsB,GAAGtB,EAAEiL,IAAI,OAAA,EAAS3J,GAAGA,EAAE6J,KAAKU,OAAOxG,KAAKgG,QAAQ,MAAM,IAAI/D,MAAMtH,EAAE4J,QAAQ,CAACjJ,IAAI,WAAWG,MAAM,SAAShB,GAAG,IAAIE,EAAE,EAAEgD,UAAU3C,aAAQ,IAAS2C,UAAU,GAAGA,UAAU,GAAG,KAAK5C,EAAEsK,OAAO1K,GAAGG,EAAEkF,KAAKsB,IAAItB,KAAKb,OAAO1B,KAAKkI,SAAS,GAAG1J,EAAE,KAAK+B,GAAGiB,MAAMnE,KAAKmB,EAAEnB,EAAEyG,KAAK,SAAS5G,GAAG,OAAOA,EAAE4J,KAAK/D,KAAK/F,EAAE+F,MAAM,IAAIxE,EAAE8J,KAAKU,MAAMxG,KAAKb,OAAOyG,IAAI,GAAG5H,GAAGE,OAAOjC,IAAb,GAAoBb,OAAO6E,OAAOhE,EAAE,CAACsI,KAAK9J,EAAEmL,IAAI5J,IAAI,OAAOjB,EAAE,CAACiD,GAAGC,MAAMhC,EAAEmD,MAAMnD,EAAEmD,KAAK9C,KAAKvB,GAAGkB,EAAEmD,KAAK,CAACrE,GAAG,IAAImB,EAAE6I,OAAO9I,EAAEmD,MAAMhE,OAAO6E,OAAOhE,EAAE,CAACmD,KAAKlD,SAAS,CAAC,IAAIC,EAAE,CAACoI,KAAK9J,EAAEmL,IAAI5J,GAAG,OAAOjB,GAAGK,OAAO6E,OAAO9D,EAAE,CAACiD,KAAK,CAACrE,KAAKD,EAAEwB,KAAKH,GAAG6D,KAAKoG,IAAIpG,KAAKb,OAAO1B,KAAKkI,OAAO7K,MAAM,CAAC,CAACQ,IAAI,YAAYgG,IAAI,WAAW,IAAI1D,OAAOsI,aAAa,OAAM,EAAG,IAAI,OAAOtI,OAAOsI,aAAaG,QAAQ,UAAU,WAAWzI,OAAOsI,aAAaK,WAAW,YAAW,EAAG,MAAM9L,GAAG,OAAM,OAAQA,EAA13F,GAA+3FiM,OAAO,WAAW,SAASjM,EAAEE,GAAGD,kBAAgBsF,KAAKvF,GAAG,IAAIM,EAAEJ,EAAEgM,IAAI7L,EAAEH,EAAE4E,MAAM,GAAGS,KAAK2G,IAAI3I,GAAGiB,MAAMlE,GAAG,GAAGA,EAAEiF,KAAKT,MAAMzE,GAAGkD,GAAGgB,IAAIlE,KAAKkD,GAAGG,OAAOrD,GAAG,MAAMiJ,MAAM,oDAAoD/D,KAAKmF,QAAQ,IAAIK,QAAQ,OAAOjK,eAAad,EAAE,CAAC,CAACa,IAAI,aAAaG,MAAM,WAAW,IAAIhB,EAAEuF,KAAK,OAAA,IAAWsD,QAAQ,SAAS3I,EAAEI,GAAG,OAAOiD,GAAGG,OAAO1D,EAAE8E,YAAY5E,EAAEF,EAAE8E,OAAO9E,EAAE8E,iBAAiB0C,WAAWtH,EAAEF,EAAE8E,MAAMiB,MAAMxC,GAAGgB,IAAIvE,EAAE8E,QAAQxE,EAAE,IAAIgJ,MAAM,yCAAyCtJ,EAAEmM,WAAWvC,KAAK,SAAS5J,GAAGE,EAAEF,EAAE+F,MAAMiE,MAAM1J,QAAQ,CAACO,IAAI,WAAWG,MAAM,WAAW,IAAIhB,EAAEuF,KAAK,OAAA,IAAWsD,QAAQ,SAAS3I,EAAEI,GAAG,GAAGiD,GAAGG,OAAO1D,EAAE8E,QAAQvB,GAAGgB,IAAIvE,EAAE8E,OAAO,CAAC,IAAIzE,EAAEL,EAAE0K,QAAQyB,SAASnM,EAAE8E,OAAO,GAAG,OAAOzE,GAAGA,aAAamH,MAAM,YAAYtH,EAAEG,GAAG,GAAGL,EAAE8E,iBAAiB0C,MAAMtH,EAAEF,EAAE8E,WAAW,CAAC,IAAItD,EAAEkD,OAAOC,KAAKG,MAAM9E,EAAEkM,IAAIlM,EAAE8E,OAAOsF,KAAKvD,IAAIrF,GAAGoI,KAAK,SAAStJ,GAAGN,EAAEoM,SAAS9L,GAAGJ,EAAEF,EAAE8E,SAASkF,MAAM1J,QAAQ,CAACO,IAAI,WAAWG,MAAM,SAAShB,GAAG,GAAGuD,GAAGE,OAAOzD,GAAG,CAAC,IAAIE,EAAEqD,GAAGgB,IAAIgB,KAAKT,OAAOS,KAAKT,MAAM,KAAKS,KAAKT,MAAM,IAAI0C,MAAMxH,GAAGuF,KAAKmF,QAAQ0B,SAAS7G,KAAKT,MAAM5E,MAAM,CAACW,IAAI,aAAaG,MAAM,SAAShB,GAAG,IAAIE,EAAEqF,KAAK,OAAA,IAAWsD,QAAQ,SAASvI,EAAED,GAAG+J,KAAKvD,IAAInC,OAAOC,KAAKV,QAAQ/D,EAAEgM,IAAIlM,IAAI4J,KAAK,SAAS5J,GAAGE,EAAE4E,iBAAiB0C,OAAOtH,EAAEkM,SAASpM,EAAE8E,OAAOxE,EAAE,IAAI+F,QAAQnG,EAAEF,MAAMgK,MAAM3J,OAAO,CAACQ,IAAI,cAAcG,MAAM,WAAW,IAAIhB,EAAEuF,KAAKrF,EAAE,EAAEgD,UAAU3C,aAAQ,IAAS2C,UAAU,GAAGA,UAAU,GAAG,GAAG5C,EAAE,EAAE4C,UAAU3C,aAAQ,IAAS2C,UAAU,GAAGA,UAAU,GAAG,GAAG7C,EAAE,EAAE6C,UAAU3C,aAAQ,IAAS2C,UAAU,GAAGA,UAAU,GAAG,EAAE,OAAA,IAAW2F,QAAQ,SAASrH,EAAED,GAAGvB,EAAEqM,aAAazC,KAAK,SAASnI,GAAG2I,KAAKvD,IAAInC,OAAOC,KAAKC,SAAS5E,EAAEkM,IAAIzK,EAAE8B,GAAGiB,MAAMtE,GAAG,GAAGA,EAAEqD,GAAGQ,SAASzD,GAAGA,EAAE,IAAIiD,GAAGG,OAAOrD,IAAI,EAAEA,EAAE,EAAEA,IAAIuJ,KAAK,SAAS1J,GAAGsB,EAAEb,OAAO6E,OAAO,GAAGtF,EAAE,CAAC0E,SAAS1E,EAAE0E,SAASwB,IAAI,SAASlG,GAAG,OAAA,IAAWmG,QAAQrG,EAAEE,UAAU8J,MAAMzI,KAAKyI,MAAMzI,OAAO,CAACV,IAAI,gBAAgBG,MAAM,WAAW,IAAIhB,EAAEuF,KAAK,OAAA,IAAWsD,QAAQ,SAAS3I,EAAEI,GAAGN,EAAEqM,aAAazC,KAAK,SAASvJ,GAAG+J,KAAKvD,IAAInC,OAAOC,KAAKE,WAAW7E,EAAEkM,IAAI7L,IAAIuJ,KAAK,SAAS5J,GAAGE,EAAES,OAAO6E,OAAO,GAAGxF,EAAE,CAAC6E,WAAW7E,EAAE6E,WAAWuB,IAAI,SAASpG,GAAG,OAAA,IAAWuH,SAASvH,UAAUgK,MAAM1J,KAAK0J,MAAM1J,OAAO,CAACO,IAAI,aAAaG,MAAM,SAAShB,EAAEE,GAAG,IAAII,EAAEiF,KAAK,OAAA,IAAWsD,QAAQ,SAASxI,EAAEmB,GAAG,OAAO+B,GAAGiB,MAAMxE,QAAQwB,EAAE,IAAI8H,MAAM,8BAA8BhJ,EAAE+L,aAAazC,KAAK,SAASrI,GAAG,IAAIE,EAAEzB,EAAE+H,cAAcqC,KAAKC,KAAK3F,OAAOC,KAAKI,WAAWzE,EAAE4L,IAAI3K,GAAG,CAAC+K,SAAS7K,EAAE8K,SAAShJ,GAAGiB,MAAMtE,GAAG,KAAKA,IAAI0J,KAAK,SAAS5J,GAAG,IAAIE,EAAE,IAAIiH,KAAK7G,EAAEN,GAAGM,EAAEoK,QAAQ8B,QAAQjL,EAAEE,EAAEvB,GAAGG,EAAEH,KAAK8J,MAAMxI,KAAKwI,MAAMxI,OAAO,CAACX,IAAI,YAAYG,MAAM,SAAShB,GAAG,IAAIE,EAAEqF,KAAK,OAAA,IAAWsD,QAAQ,SAASvI,EAAED,GAAG,OAAOkD,GAAGS,aAAahE,QAAQE,EAAEmM,aAAazC,KAAK,SAASpI,GAAG,IAAID,EAAEvB,EAAE+H,cAActG,EAAEvB,EAAEwK,QAAQ1F,QAAQxD,EAAED,GAAGgC,GAAGiB,MAAM/C,GAAGvB,EAAE6E,WAAWxD,GAAGqI,KAAK,SAAS5J,GAAG,OAAOM,EAAEN,EAAE+F,MAAMiE,MAAM3J,GAAGC,EAAEmB,EAAEsE,MAAMiE,MAAM3J,QAAQA,EAAE,IAAIiJ,MAAM,0CAA0C,CAACzI,IAAI,UAAUG,MAAM,SAAShB,GAAG,IAAIE,EAAEqF,KAAK,OAAA,IAAWsD,QAAQ,SAASvI,EAAED,GAAG,IAAImB,EAAE+B,GAAGS,aAAahE,GAAGuB,EAAEgC,GAAGQ,SAAS/D,GAAG,GAAGwB,GAAGD,EAAN,GAAWC,EAAE,CAAC,IAAIC,EAAEzB,EAAE+H,cAAc7H,EAAEuM,UAAUhL,GAAGmI,KAAK,SAAS5J,GAAG,OAAOuD,GAAGiB,MAAMxE,QAAQK,EAAE,IAAIiJ,MAAM,mDAAmDjG,OAAO5B,EAAE,YAAYvB,EAAE8E,QAAQhF,GAAG4J,KAAK,SAAS5J,GAAGE,EAAEkM,SAASpM,EAAE8E,OAAOxE,EAAEN,KAAKgK,MAAM3J,KAAK2J,MAAM3J,QAAQ+J,KAAKvD,IAAInC,OAAOC,KAAKK,QAAQ9E,EAAEgM,IAAIlM,IAAI4J,KAAK,SAAS5J,GAAG,IAAIK,EAAEH,EAAEwM,gBAAgBlL,EAAE,IAAI2F,KAAKjH,EAAEF,EAAEA,EAAE+F,KAAK1F,GAAGH,EAAEkM,SAAS5K,EAAEsD,OAAOxE,EAAEkB,KAAKwI,MAAM3J,QAAQA,EAAE,IAAIiJ,MAAM,sDAAsD,CAACzI,IAAI,WAAWG,MAAM,WAAW,IAAIhB,EAAEuF,KAAKrF,IAAI,EAAEgD,UAAU3C,aAAQ,IAAS2C,UAAU,KAAKA,UAAU,GAAG,OAAA,IAAW2F,QAAQ,SAASvI,EAAED,GAAGL,EAAEqM,aAAazC,KAAK,SAASpI,GAAG,IAAID,EAAEvB,EAAE0K,QAAQsB,SAASxK,GAAG,GAAG+B,GAAGiB,MAAMjD,GAAGjB,EAAE,WAAjB,GAA+BJ,EAAE,CAAC,IAAIuB,EAAEd,OAAOqC,KAAKzB,GAAG6E,IAAI,SAASpG,GAAG,OAAOuB,EAAEvB,GAAG+F,KAAKqE,KAAKvD,IAAInC,OAAOC,KAAKM,WAAWjF,EAAEkM,IAAIzK,EAAEkL,KAAK,OAAO/C,KAAK,SAAS1J,GAAGS,OAAOiM,QAAQ1M,GAAGmI,QAAQ,SAASrI,GAAG,IAAIE,EAAEe,iBAAejB,EAAE,GAAGM,EAAEJ,EAAE,GAAG,IAAIA,EAAE,GAAG,CAAC,IAAIG,EAAEM,OAAOqC,KAAKzB,GAAGuF,KAAK,SAAS9G,GAAG,OAAOuB,EAAEvB,GAAG+F,KAAKzF,WAAWiB,EAAElB,MAAML,EAAE0K,QAAQmC,SAASrL,EAAED,GAAGZ,OAAOmM,OAAOvL,GAAGuF,KAAK,SAAS9G,GAAG,OAAOA,EAAEoH,SAAS9G,EAAEiB,GAAGvB,EAAE+M,gBAAgBnD,KAAKtJ,GAAG0J,MAAM3J,KAAK2J,MAAM3J,QAAQC,EAAEiB,KAAKyI,MAAM3J,OAAO,CAACQ,IAAI,gBAAgBG,MAAM,WAAW,IAAIhB,EAAEuF,KAAKrF,EAAE,EAAEgD,UAAU3C,aAAQ,IAAS2C,UAAU,GAAGA,UAAU,GAAG,KAAK,OAAA,IAAW2F,QAAQ,SAASvI,EAAED,GAAGL,EAAEqM,aAAazC,KAAK,SAASpI,GAAGxB,EAAEgM,UAAS,GAAIpC,KAAK,SAASrI,GAAG,IAAIE,EAAEF,EAAE,GAAGgC,GAAGiB,MAAM/C,GAAGnB,EAAE,UAAU,CAAC,GAAGiD,GAAGS,aAAa9D,GAAG,CAAC,IAAIwB,EAAExB,EAAE6H,cAAcyB,EAAE7I,OAAOqC,KAAKvB,GAAG,IAAI+H,EAAEd,SAAShH,GAAG,YAAYrB,EAAE,IAAIiJ,MAAM,gBAAgBjG,OAAO3B,KAAK8H,EAAEnB,QAAQ,SAASrI,GAAGyB,EAAEzB,GAAGoH,OAAOpH,IAAI0B,QAAQ,CAAC,IAAIsL,EAAEzJ,GAAGQ,SAAS7D,GAAGA,EAAEuB,EAAEd,OAAOqC,KAAKvB,GAAG,IAAIsE,GAAGpF,OAAOqC,KAAKvB,GAAG4G,QAAQ,SAASrI,GAAG,IAAIE,EAAEuB,EAAEzB,GAAGE,EAAEkH,OAAOlH,EAAE6F,KAAKiH,IAAIhN,EAAE0K,QAAQmC,SAASrL,EAAEC,GAAGnB,EAAEmB,QAAQuI,MAAM3J,OAAO,CAACQ,IAAI,gBAAgBG,MAAM,WAAW,IAAIhB,EAAEuF,KAAKrF,KAAK,EAAEgD,UAAU3C,aAAQ,IAAS2C,UAAU,KAAKA,UAAU,GAAG,OAAA,IAAW2F,QAAQ,SAASvI,EAAED,GAAGL,EAAEqM,aAAazC,KAAK,SAASpI,GAAG,IAAID,EAAEvB,EAAE0K,QAAQsB,SAASxK,GAAG,GAAGb,OAAOqC,KAAKzB,GAAGhB,OAAO,CAAC,IAAIkB,EAAEd,OAAOmM,OAAOvL,GAAGuF,KAAK,SAAS9G,GAAG,OAAOA,EAAEoH,SAAS,OAAO3F,EAAEvB,OAAOF,EAAEgF,QAAQvD,EAAEsE,IAAI6D,KAAKtJ,GAAG0J,MAAM3J,QAAQC,EAAEmB,EAAEsE,SAASzF,EAAE,MAAMA,EAAE,QAAQ0J,MAAM3J,OAAO,CAACQ,IAAI,YAAYG,MAAM,SAAShB,EAAEE,GAAG,IAAII,EAAEiF,KAAK,OAAA,IAAWsD,QAAQ,SAASxI,EAAEmB,GAAG,OAAO+B,GAAGQ,SAAS/D,GAAGuD,GAAGiB,MAAMtE,QAAQsB,EAAE,IAAI8H,MAAM,qCAAqCc,KAAKC,KAAK3F,OAAOC,KAAKO,UAAU5E,EAAE4L,IAAIlM,GAAGE,GAAG0J,KAAK,SAAS5J,GAAG,IAAIE,EAAE,IAAIiH,KAAK7G,EAAEN,GAAE,GAAIM,EAAE8L,SAASlM,EAAE4E,OAAOxE,EAAEyM,cAAc7M,EAAE6F,IAAI6D,KAAK,WAAWvJ,EAAEH,KAAK8J,MAAMxI,KAAKwI,MAAMxI,QAAQA,EAAE,IAAI8H,MAAM,+BAA+B,CAACzI,IAAI,yBAAyBG,MAAM,SAAShB,EAAEE,GAAG,IAAII,EAAEiF,KAAKlF,EAAE,EAAE6C,UAAU3C,aAAQ,IAAS2C,UAAU,GAAGA,UAAU,GAAG,EAAE,OAAA,IAAW2F,QAAQ,SAASrH,EAAED,GAAG,OAAOgC,GAAGQ,SAAS/D,GAAGuD,GAAGiB,MAAMtE,QAAQqB,EAAE,IAAI+H,MAAM,mCAAmCc,KAAKC,KAAK3F,OAAOC,KAAKQ,uBAAuB7E,EAAE4L,IAAIlM,GAAG,CAACiN,MAAM/M,EAAEgN,SAAS7M,IAAIuJ,KAAK,SAAS5J,GAAG,IAAIE,EAAE,IAAIiH,KAAK7G,EAAEN,GAAE,GAAIM,EAAE8L,SAASlM,EAAE4E,OAAOxE,EAAEyM,cAAc7M,EAAE6F,IAAI6D,KAAK,WAAWpI,EAAEtB,KAAK8J,MAAMzI,KAAKyI,MAAMzI,QAAQA,EAAE,IAAI+H,MAAM,+BAA+B,CAACzI,IAAI,iBAAiBG,MAAM,SAAShB,EAAEE,GAAG,IAAII,EAAEiF,KAAK,OAAA,IAAWsD,QAAQ,SAASxI,EAAEmB,GAAG,OAAO+B,GAAGQ,SAAS/D,GAAGuD,GAAGiB,MAAMtE,QAAQsB,EAAE,IAAI8H,MAAM,mCAAmCc,KAAKC,KAAK3F,OAAOC,KAAKS,eAAe9E,EAAE4L,IAAIlM,GAAG,CAACiN,MAAM/M,IAAI0J,KAAK,SAAS5J,GAAG,GAAGuD,GAAGiB,MAAMxE,GAAGM,EAAE0L,WAAWpC,KAAK,WAAW,OAAOvJ,EAAE,QAAQ2J,MAAMxI,OAAO,CAAC,IAAItB,EAAE,IAAIiH,KAAK7G,EAAEN,GAAE,GAAIM,EAAEyM,cAAc7M,EAAE6F,IAAI6D,KAAK,WAAWvJ,EAAEH,KAAK8J,MAAMxI,MAAMwI,MAAMxI,QAAQA,EAAE,IAAI8H,MAAM,iCAAiCtJ,EAA5sM,GDEnoZmN,SAASzD,iBAAiB,mBAAoB,WAG1C,SAAS0D,EAAInH,EAAO6D,GAAM,IAChBuD,EAAUF,SAASG,cAAc,WACjCC,EAAUJ,SAASG,cAAc,WACvCC,EAAQC,UAAYvH,EACpBoH,EAAQI,YAAYF,GAJE,IAMhBG,EAAWP,SAASG,cAAc,OAClCK,EAAMR,SAASG,cAAc,OACnCK,EAAIC,UAAUC,IAAI,eAClBF,EAAIH,UAAY1E,KAAK+C,UAAU/B,EAAM,KAAM,GAC3C4D,EAASD,YAAYE,GACrBN,EAAQI,YAAYC,GAEpBI,EAAOL,YAAYJ,GAEnBlK,OAAO4K,cAGX,SAASC,EAAK/H,EAAO8D,GAAQ,OACrBA,aAAkBT,MAEX8D,EAAG,GAAA/J,OAAI4C,EAAJ,YAAqB,CAAEgI,MAAOlE,EAAOnC,aAG5CwF,EAAG,GAAA/J,OAAI4C,EAAJ,aAAsB8D,GAiCpC,SAAS7E,EAAUjB,IApBnB,SAAiBqI,GACb,OAAA,IAAWzD,QAAQ,SAACqF,EAASC,GAAW,OAChChL,OAAOgB,UACP+J,EAAQ/K,OAAOgB,WAInBkB,EACKL,QAAQsH,GACR1C,KAAK,SAAAzF,GACFiJ,EAAI,WAAYjJ,GAEhBhB,OAAOgB,KAAOA,EAEd+J,EAAQ/J,KAEX6F,MAAM,SAAAiE,GAAK,OAAIE,EAAOF,QAK/BjJ,CAAQf,EAAQmK,eACXxE,KAAK,SAAAzF,GACF,IAAIkK,EAAU,KAEiB,iBAApBpK,EAAQoK,SAAwBpK,EAAQoK,QAAQ9N,OACpD8N,EAAYpK,EAAZoK,QACIpK,EAAQyC,UAAYzC,EAAQyC,SAASnG,SAC5C8N,EAAUpK,EAAQyC,SAAS,GAAGX,IAGlC5B,EAAK0J,IAAI,CACL9H,GAAI9B,EAAQ8B,GACZmH,SAAU,EACVhG,WAAYmH,IAEXzE,KAAK,SAAA0E,GACFlB,EAAI,cAAekB,GAEnBnL,OAAOgB,KAAOmK,IAEjBtE,MAAM,SAAAiE,GAAK,OAAID,EAAK,cAAeC,OAE3CjE,MAAM,SAAAiE,GAAK,OAAID,EAAK,WAAYC,KAnFO,IAC1CH,EAASX,SAASoB,eAAe,UA6BjClJ,EAAS,IAAI4G,OAAO,CACtBnH,MAAO,oBACPoH,IAAK,mBAIT/I,OAAOkC,OAASA,EAEhB+H,EAAI,SAAU/H,GAqDdA,EACKmJ,WALI,0BAMJ5E,KAAK,SAAA3F,GACFmJ,EAAI,UAAWnJ,GAGfd,OAAOc,QAAUA,EAEjBiB,EAAUjB,KAEb+F,MAAM,SAAAD,GAAM,OAAIiE,EAAK,UAAWjE","file":"scripts.js","sourcesContent":["import Client from '../../dist/client';\n\ndocument.addEventListener('DOMContentLoaded', () => {\n    const output = document.getElementById('output');\n\n    function log(label, data) {\n        const details = document.createElement('details');\n        const summary = document.createElement('summary');\n        summary.innerHTML = label;\n        details.appendChild(summary);\n\n        const contents = document.createElement('div');\n        const pre = document.createElement('pre');\n        pre.classList.add('prettyprint');\n        pre.innerHTML = JSON.stringify(data, null, 4);\n        contents.appendChild(pre);\n        details.appendChild(contents);\n\n        output.appendChild(details);\n\n        window.prettyPrint();\n    }\n\n    function fail(label, errors) {\n        if (errors instanceof Error) {\n            // console.error(errors);\n            return log(`${label} (error)`, { error: errors.toString() });\n        }\n\n        return log(`${label} (failed)`, errors);\n    }\n\n    const client = new Client({\n        store: 'local.sampotts.me',\n        env: 'local-selz.com',\n    });\n\n    // Expose\n    window.client = client;\n\n    log('Client', client);\n\n    function getCart(currency) {\n        return new Promise((resolve, reject) => {\n            if (window.cart) {\n                resolve(window.cart);\n                return;\n            }\n\n            client\n                .getCart(currency)\n                .then(cart => {\n                    log('Get cart', cart);\n\n                    window.cart = cart;\n\n                    resolve(cart);\n                })\n                .catch(error => reject(error));\n        });\n    }\n\n    function addToCart(product) {\n        getCart(product.currency_code)\n            .then(cart => {\n                let variant = null;\n\n                if (typeof product.variant === 'string' && product.variant.length) {\n                    ({ variant } = product);\n                } else if (product.variants && product.variants.length) {\n                    variant = product.variants[0].id;\n                }\n\n                cart.add({\n                    id: product.id,\n                    quantity: 2,\n                    variant_id: variant,\n                })\n                    .then(updatedCart => {\n                        log('Add to cart', updatedCart);\n\n                        window.cart = updatedCart;\n                    })\n                    .catch(error => fail('Add to cart', error));\n            })\n            .catch(error => fail('Get cart', error));\n    }\n\n    const products = {\n        GBP: 'http://selz.co/1MaSYRU',\n        USD: 'http://selz.co/1rvbhT6',\n    };\n\n    client\n        .getProduct(products.GBP)\n        .then(product => {\n            log('Product', product);\n\n            // Expose\n            window.product = product;\n\n            addToCart(product);\n        })\n        .catch(errors => fail('Product', errors));\n\n    // Listen for messages from parent\n    /* window.addEventListener('message', event => {\n        // console.warn(event.data);\n        const json = JSON.parse(event.data);\n\n        if (json.key !== 'add-to-cart') {\n            return;\n        }\n\n        addToCart(json.data);\n    }); */\n});\n","function _typeof(t){return(_typeof=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&\"function\"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?\"symbol\":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),t}function _defineProperty(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_nonIterableRest()}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _iterableToArrayLimit(t,e){var r=[],n=!0,i=!1,o=void 0;try{for(var s,c=t[Symbol.iterator]();!(n=(s=c.next()).done)&&(r.push(s.value),!e||r.length!==e);n=!0);}catch(t){i=!0,o=t}finally{try{n||null==c.return||c.return()}finally{if(i)throw o}}return r}function _nonIterableRest(){throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")}var getConstructor=function(t){return null!=t?t.constructor:null},instanceOf=function(t,e){return!!(t&&e&&t instanceof e)},isArray=function(t){return Array.isArray(t)},isObject=function(t){return getConstructor(t)===Object},isNumber=function(t){return getConstructor(t)===Number&&!Number.isNaN(t)},isString=function(t){return getConstructor(t)===String},isBoolean=function(t){return getConstructor(t)===Boolean},isFunction=function(t){return getConstructor(t)===Function},isNullOrUndefined=function(t){return null==t},isObjectId=function(t){return isString(t)&&/^[a-f\\d]{24}$/i.test(t)},isCurrencyCode=function(t){return isString(t)&&/^[A-z]{3}$/.test(t)},isEmpty=function(t){return isNullOrUndefined(t)||(isString(t)||isArray(t))&&!t.length||isObject(t)&&!Object.keys(t).length},isUrl=function(t){var e=!!(1<arguments.length&&void 0!==arguments[1])&&arguments[1];if(instanceOf(t,window.URL))return!0;var r=t;e||/^https?:\\/\\/*/.test(t)||(r=\"http://\".concat(t));try{return!isEmpty(new URL(r).hostname)}catch(t){return!1}},is={array:isArray,object:isObject,number:isNumber,string:isString,boolean:isBoolean,function:isFunction,nullOrUndefined:isNullOrUndefined,objectId:isObjectId,currencyCode:isCurrencyCode,product:isProduct,cart:isCart,category:isCategory,url:isUrl,empty:isEmpty},getBase=function(t){return\"https://\".concat(is.empty(t)?\"sdk.selz.com\":\"\".concat(t,\"/sdk\"),\"/\")},config={urls:{product:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:\"\";return\"\".concat(getBase(t),\"products/find?url=\").concat(e)},products:function(t,e){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:\"\",n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:\"\",i=4<arguments.length&&void 0!==arguments[4]?arguments[4]:1;return\"\".concat(getBase(t),\"products/all/\").concat(e,\"?q=\").concat(r,\"&c=\").concat(n,\"&p=\").concat(i)},categories:function(t,e){return\"\".concat(getBase(t),\"categories/\").concat(e)},store:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;return is.number(e)?\"\".concat(getBase(t),\"store/find/\").concat(e):\"\".concat(getBase(t),\"store/find?url=\").concat(e)},createCart:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:\"\";return\"\".concat(getBase(t),\"cart/create/\").concat(e)},getCart:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:\"\";return\"\".concat(getBase(t),\"cart/\").concat(e)},checkCarts:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:\"\";return\"\".concat(getBase(t),\"cart/verify?ids=\").concat(e)},addToCart:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:\"\";return\"\".concat(getBase(t),\"cart/add/\").concat(e)},updateCartItemQuantity:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:\"\";return\"\".concat(getBase(t),\"cart/updateitemquantity/\").concat(e)},removeFromCart:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:\"\";return\"\".concat(getBase(t),\"cart/remove/\").concat(e)}}},client=null,ProductUrls=function t(e){_classCallCheck(this,t),Object.assign(this,e)},ProductImage=function t(e){_classCallCheck(this,t),Object.assign(this,e)},ProductMedia=function t(e){_classCallCheck(this,t),Object.assign(this,e),this.cover=new ProductImage(e.cover)},ProductFile=function t(e){_classCallCheck(this,t),Object.assign(this,e)},ProductVariant=function t(e){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:\"\";_classCallCheck(this,t),Object.assign(this,e),this.selected=e.id===r},ProductVariantAttributeOption=function t(e,r){_classCallCheck(this,t),this.id=e,this.label=r},ProductVariantAttribute=function t(e){_classCallCheck(this,t),Object.assign(this,e),this.options=Object.keys(e.options).map(function(t){return new ProductVariantAttributeOption(t,e.options[t])})},Product=function(){function t(e,r){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:\"\";if(_classCallCheck(this,t),is.object(r)){if(client=e,Object.assign(this,r),this.store=client.store,is.object(r.urls)&&(this.urls=new ProductUrls(r.urls)),is.object(r.media)&&(this.media=new ProductMedia(r.media)),is.array(r.images)&&(this.images=r.images.map(function(t){return new ProductImage(t)})),is.array(r.files)&&(this.files=r.files.map(function(t){return new ProductFile(t)})),r.has_variants){var i=is.empty(n)?r.variants[0].id:n;this.variants=r.variants.map(function(t){return new ProductVariant(t,i)})}r.has_variant_attributes&&(this.variant_attributes=r.variant_attributes.map(function(t){return new ProductVariantAttribute(t)}))}}return _createClass(t,[{key:\"selected_variant\",get:function(){return is.empty(this.variants)?null:this.variants.find(function(t){return t.selected})}}]),t}(),client$1=null,CartItem=function t(e,r){_classCallCheck(this,t),this.cartId=r,Object.assign(this,e),this.product=new Product(client$1,e.product,e.variant_id)},Cart=function(){function t(e,r){var n=!!(2<arguments.length&&void 0!==arguments[2])&&arguments[2];_classCallCheck(this,t),null===r||(client$1=e,Object.assign(this,r),this.store=client$1.store,this.active=n,this.items=Array.from(r.items).map(function(t){return new CartItem(t,r.id)}))}return _createClass(t,[{key:\"add\",value:function(t){return client$1.addToCart(this.id,t)}},{key:\"remove\",value:function(t){return client$1.removeFromCart(this.id,t)}}]),t}(),Category=function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;_classCallCheck(this,t),is.object(e)&&Object.assign(this,e)},Store=function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;_classCallCheck(this,t),is.object(e)&&Object.assign(this,e)};function replaceAll(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:\"\",e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:\"\",r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:\"\";return t.replace(new RegExp(e.toString().replace(/([.*+?^=!:${}()|[\\]\\/\\\\])/g,\"\\\\$1\"),\"g\"),r.toString())}function toTitleCase(){return(0<arguments.length&&void 0!==arguments[0]?arguments[0]:\"\").toString().replace(/\\w\\S*/g,function(t){return t.charAt(0).toUpperCase()+t.substr(1).toLowerCase()})}function toPascalCase(){var t=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:\"\").toString();return t=replaceAll(t,\"-\",\" \"),t=replaceAll(t,\"_\",\" \"),replaceAll(t=toTitleCase(t),\" \",\"\")}var buildFormData=function(){var t,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=1<arguments.length?arguments[1]:void 0,n=2<arguments.length?arguments[2]:void 0,i=r||new FormData;return is.object(e)?(Object.keys(e).forEach(function(r){t=n?\"\".concat(n,\"[\").concat(r,\"]\"):r,\"object\"!==_typeof(e[r])||e[r]instanceof File?i.append(toPascalCase(t),e[r]):buildFormData(e[r],i,r)}),i):i};function extend(){for(var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length,r=Array(1<e?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];if(!r.length)return t;var i=r.shift();return is.object(i)?(Object.keys(i).forEach(function(e){is.object(i[e])?(!Object.keys(t).includes(e)&&Object.assign(t,_defineProperty({},e,{})),extend(t[e],i[e])):Object.assign(t,_defineProperty({},e,i[e]))}),extend.apply(void 0,[t].concat(r))):t}function parseJSON(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return new Promise(function(e,r){try{e(JSON.parse(t))}catch(t){r(t)}})}var defaults={type:\"GET\",body:{},responseType:\"json\"};function fetch(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=extend({},defaults,e),n=r.type,i=r.body,o=r.responseType;return new Promise(function(e,r){try{var s=new XMLHttpRequest;if(!(\"withCredentials\"in s)){var c=new Error(\"No CORS support\");throw c.request=s,c}var a=function(){var t=new Error(s.status);t.request=s,r(t)};s.addEventListener(\"load\",function(){var t=s.response;return 400<=s.status?void a():void(\"json\"===o?parseJSON(t).then(function(t){if(t.success)e(t.data);else{var n=new Error(\"Request failed\");n.errors=t.errors,r(n)}}).catch(r):e(t))}),s.addEventListener(\"error\",a),s.open(n,t,!0),\"json\"!==o&&(s.responseType=o),s.send(buildFormData(i))}catch(t){r(t)}})}var queue={},http={get:function(t){if(!Object.keys(queue).includes(t)){queue[t]=fetch(t);var e=function(){delete queue[t]};queue[t].then(e).catch(e)}return queue[t]},post:function(t){return fetch(t,{type:\"POST\",body:1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}})}};function dedupe(t){return is.array(t)?t.filter(function(e,r){return t.indexOf(e)===r}):t}function parseUrl(t){var e=t;/^https?:\\/\\/*/.test(t)||(e=\"http://\".concat(t));try{return new URL(e)}catch(t){return null}}var storage=new Map,getKey=function(t){if(null===t)return null;var e=parseUrl(t);return null===e?null:\"\".concat(e.host).concat(e.pathname).replace(/\\/$/,\"\")},Storage=function(){function t(e){_classCallCheck(this,t),this.config=Object.assign({keys:{root:\"selz-js-sdk\",carts:\"carts\",stores:\"stores\"},ttl:3600,schema:new Date(\"2018-07-02\").getTime()},e),this.purge()}return _createClass(t,[{key:\"get\",value:function(e){var r=storage.get(this.config.keys.root);if(t.supported){var n=window.localStorage.getItem(this.config.keys.root);is.empty(n)||(r=JSON.parse(n))}return is.empty(r)?null:is.empty(e)?r:Object.keys(r).includes(e)?r[e]:null}},{key:\"set\",value:function(e,r){var n=!!(2<arguments.length&&void 0!==arguments[2])&&arguments[2],i=this.get()||{};if(i[e]=n&&Object.keys(i).includes(e)?extend(i[e],r):r,storage.set(this.config.keys.root,i),t.supported){i.schema=this.config.schema;try{window.localStorage.setItem(this.config.keys.root,JSON.stringify(i))}catch(t){}}}},{key:\"purge\",value:function(){var t=this.get();if(!is.empty(t)){if(+t.schema!==this.config.schema)return void window.localStorage.removeItem(this.config.keys.root);var e=this.get(this.config.keys.stores)||[];is.empty(e)||this.set(this.config.keys.stores,e.filter(function(t){var e=+t.ttl;return 0<e&&e>Date.now()}))}}},{key:\"getCarts\",value:function(t){var e=this.get(this.config.keys.carts)||{};return is.empty(e)?null:is.number(t)?Object.keys(e).includes(t.toString())?e[t.toString()]:null:e}},{key:\"getCart\",value:function(t,e){var r=this.getCarts(t);return is.empty(r)?null:is.string(e)?Object.keys(r).includes(e.toUpperCase())?r[e.toUpperCase()]:null:r}},{key:\"setCart\",value:function(t,e,r){this.set(this.config.keys.carts,_defineProperty({},t,_defineProperty({},e.toUpperCase(),{id:r.id,active:r.active})),!0)}},{key:\"setCarts\",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};this.set(this.config.keys.carts,_defineProperty({},t,e))}},{key:\"getStore\",value:function(t){var e=null;if(!is.number(t)&&!is.url(t))return null;var r=this.get(this.config.keys.stores)||[];if(is.number(t))e=r.find(function(e){return is.object(e.data)&&e.data.id===t});else if(is.url(t)){var n=getKey(t);if(null===n)return null;e=r.find(function(t){return is.array(t.urls)&&t.urls.includes(n)})}if(!is.object(e))return null;var i=+e.ttl;return 0<i&&i<Date.now()?(this.purge(),null):new Store(e.data)}},{key:\"setStore\",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,r=getKey(e),n=this.get(this.config.keys.stores)||[],i=null;is.empty(n)||(i=n.find(function(e){return e.data.id===t.id}));var o=Date.now()+this.config.ttl;if(is.object(i)){if(Object.assign(i,{data:t,ttl:o}),null!==r){is.array(i.urls)?i.urls.push(r):i.urls=[r];var s=dedupe(i.urls);Object.assign(i,{urls:s})}}else{var c={data:t,ttl:o};null!==r&&Object.assign(c,{urls:[r]}),n.push(c)}this.set(this.config.keys.stores,n)}}],[{key:\"supported\",get:function(){if(!window.localStorage)return!1;try{return window.localStorage.setItem(\"___test\",\"___test\"),window.localStorage.removeItem(\"___test\"),!0}catch(t){return!1}}}]),t}(),Client=function(){function t(e){_classCallCheck(this,t);var r=e.env,n=e.store;if(this.env=is.empty(r)?\"\":r,this.store=n,!is.url(n)&&!is.number(n))throw Error(\"A store ID or URL is required to create a client\");this.storage=new Storage}return _createClass(t,[{key:\"getStoreId\",value:function(){var t=this;return new Promise(function(e,r){return is.number(t.store)?void e(t.store):t.store instanceof Store?void e(t.store.id):(!is.url(t.store)&&r(new Error(\"Url is required for user lookup\")),void t.getStore().then(function(t){e(t.id)}).catch(r))})}},{key:\"getStore\",value:function(){var t=this;return new Promise(function(e,r){if(is.number(t.store)||is.url(t.store)){var n=t.storage.getStore(t.store);if(null!==n&&n instanceof Store)return void e(n)}if(t.store instanceof Store)e(t.store);else{var i=config.urls.store(t.env,t.store);http.get(i).then(function(r){t.setStore(r),e(t.store)}).catch(r)}})}},{key:\"setStore\",value:function(t){if(is.object(t)){var e=is.url(this.store)?this.store:null;this.store=new Store(t),this.storage.setStore(this.store,e)}}},{key:\"getProduct\",value:function(t){var e=this;return new Promise(function(r,n){http.get(config.urls.product(e.env,t)).then(function(t){e.store instanceof Store||e.setStore(t.store),r(new Product(e,t))}).catch(n)})}},{key:\"getProducts\",value:function(){var t=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:\"\",r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:\"\",n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1;return new Promise(function(i,o){t.getStoreId().then(function(s){http.get(config.urls.products(t.env,s,is.empty(e)?\"\":e,is.objectId(r)?r:\"\",!is.number(n)||1>n?1:n)).then(function(e){i(Object.assign({},e,{products:e.products.map(function(e){return new Product(t,e)})}))}).catch(o)}).catch(o)})}},{key:\"getCategories\",value:function(){var t=this;return new Promise(function(e,r){t.getStoreId().then(function(n){http.get(config.urls.categories(t.env,n)).then(function(t){e(Object.assign({},t,{categories:t.categories.map(function(t){return new Category(t)})}))}).catch(r)}).catch(r)})}},{key:\"createCart\",value:function(t,e){var r=this;return new Promise(function(n,i){return is.empty(t)?void i(new Error(\"currency is required\")):void r.getStoreId().then(function(o){var s=t.toUpperCase();http.post(config.urls.createCart(r.env,o),{currency:s,discount:is.empty(e)?null:e}).then(function(t){var e=new Cart(r,t);r.storage.setCart(o,s,e),n(e)}).catch(i)}).catch(i)})}},{key:\"getCartId\",value:function(t){var e=this;return new Promise(function(r,n){return is.currencyCode(t)?void e.getStoreId().then(function(i){var o=t.toUpperCase(),s=e.storage.getCart(i,o);is.empty(s)?e.createCart(o).then(function(t){return r(t.id)}).catch(n):r(s.id)}).catch(n):void n(new Error(\"A valid currency code is required\"))})}},{key:\"getCart\",value:function(t){var e=this;return new Promise(function(r,n){var i=is.currencyCode(t),o=is.objectId(t);if(i||o)if(i){var s=t.toUpperCase();e.getCartId(s).then(function(t){return is.empty(t)?void n(new Error(\"Could not find matching cart for currency code '\".concat(s,\"'\"))):void e.getCart(t).then(function(t){e.setStore(t.store),r(t)}).catch(n)}).catch(n)}else http.get(config.urls.getCart(e.env,t)).then(function(t){var n=e.getActiveCart(),i=new Cart(e,t,t.id===n);e.setStore(i.store),r(i)}).catch(n);else n(new Error(\"A valid currency code or cart id are required\"))})}},{key:\"getCarts\",value:function(){var t=this,e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];return new Promise(function(r,n){t.getStoreId().then(function(i){var o=t.storage.getCarts(i);if(is.empty(o))r(null);else if(e){var s=Object.keys(o).map(function(t){return o[t].id});http.get(config.urls.checkCarts(t.env,s.join(\",\"))).then(function(e){Object.entries(e).forEach(function(t){var e=_slicedToArray(t,2),r=e[0];if(!e[1]){var n=Object.keys(o).find(function(t){return o[t].id===r});delete o[n]}}),t.storage.setCarts(i,o),Object.values(o).find(function(t){return t.active})?r(o):t.setActiveCart().then(r).catch(n)}).catch(n)}else r(o)}).catch(n)})}},{key:\"setActiveCart\",value:function(){var t=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;return new Promise(function(r,n){t.getStoreId().then(function(i){t.getCarts(!1).then(function(o){var s=o;if(is.empty(s))r(null);else{if(is.currencyCode(e)){var c=e.toUpperCase(),a=Object.keys(s);if(!a.includes(c))return void n(new Error(\"No carts for \".concat(c)));a.forEach(function(t){s[t].active=t===c})}else{var u=is.objectId(e)?e:s[Object.keys(s)[0]].id;Object.keys(s).forEach(function(t){var e=s[t];e.active=e.id===u})}t.storage.setCarts(i,s),r(s)}})}).catch(n)})}},{key:\"getActiveCart\",value:function(){var t=this,e=!!(0<arguments.length&&void 0!==arguments[0])&&arguments[0];return new Promise(function(r,n){t.getStoreId().then(function(i){var o=t.storage.getCarts(i);if(Object.keys(o).length){var s=Object.values(o).find(function(t){return t.active});return s?e?void t.getCart(s.id).then(r).catch(n):void r(s.id):void r(null)}r(null)}).catch(n)})}},{key:\"addToCart\",value:function(t,e){var r=this;return new Promise(function(n,i){return is.objectId(t)?is.empty(e)?void i(new Error(\"A valid product is required\")):void http.post(config.urls.addToCart(r.env,t),e).then(function(t){var e=new Cart(r,t,!0);r.setStore(e.store),r.setActiveCart(e.id).then(function(){n(e)}).catch(i)}).catch(i):void i(new Error(\"A valid id is required\"))})}},{key:\"updateCartItemQuantity\",value:function(t,e){var r=this,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1;return new Promise(function(i,o){return is.objectId(t)?is.empty(e)?void o(new Error(\"A valid index is required\")):void http.post(config.urls.updateCartItemQuantity(r.env,t),{index:e,quantity:n}).then(function(t){var e=new Cart(r,t,!0);r.setStore(e.store),r.setActiveCart(e.id).then(function(){i(e)}).catch(o)}).catch(o):void o(new Error(\"A valid id is required\"))})}},{key:\"removeFromCart\",value:function(t,e){var r=this;return new Promise(function(n,i){return is.objectId(t)?is.empty(e)?void i(new Error(\"A valid index is required\")):void http.post(config.urls.removeFromCart(r.env,t),{index:e}).then(function(t){if(is.empty(t))r.getCarts().then(function(){return n(null)}).catch(i);else{var e=new Cart(r,t,!0);r.setActiveCart(e.id).then(function(){n(e)}).catch(i)}}).catch(i):void i(new Error(\"A valid id is required\"))})}}]),t}();export default Client;export{Product,Category,Cart,CartItem,Store};"]}