{"version":3,"file":"scripts.es5.js","sources":["scripts.js"],"sourcesContent":["document.addEventListener('DOMContentLoaded', () => {\n    const output = document.getElementById('output');\n\n    function log(label, data) {\n        const details = document.createElement('details');\n\n        const summary = document.createElement('summary');\n        summary.innerHTML = label;\n        details.appendChild(summary);\n\n        const contents = document.createElement('div');\n        const pre = document.createElement('pre');\n        pre.classList.add('prettyprint');\n        pre.innerHTML = JSON.stringify(data, null, 4);\n        contents.appendChild(pre);\n        details.appendChild(contents);\n\n        output.appendChild(details);\n\n        window.prettyPrint();\n    }\n\n    function fail(label, errors) {\n        if (errors instanceof Error) {\n            console.error(errors);\n            return log(`${label} (error)`, { error: errors.toString() });\n        }\n\n        return log(`${label} (failed)`, errors);\n    }\n\n    const client = new SelzClient({\n        id: 13,\n        // domain: 'local.sampotts.me',\n        env: 'local',\n        colors: { buttons: { background: '#303e4c', text: '#97e66a' }, checkout: { background: '#303e4c', text: '#97e66a' } },\n    });\n\n    // Expose\n    window.client = client;\n\n    log('Config', client.config);\n\n    // Listen for messages\n    // window.addEventListener('message', event => console.warn(event), false);\n\n    function getCart(currency) {\n        return new Promise((resolve, reject) => {\n            if (window.cart) {\n                resolve(window.cart);\n                return;\n            }\n\n            client\n                .getCart(currency)\n                .then(cart => {\n                    log('Get cart', cart);\n\n                    window.cart = cart;\n\n                    resolve(cart);\n                })\n                .catch(error => reject(error));\n        });\n    }\n\n    function addToCart(product, checkout = false) {\n        getCart(product.currency_code)\n            .then(cart => {\n                let variant = null;\n\n                if (typeof product.variant === 'string' && product.variant.length) {\n                    variant = product.variant; //eslint-disable-line\n                } else if (product.variants && product.variants.length) {\n                    variant = product.variants[0].id;\n                }\n\n                cart\n                    .add({\n                        id: product.id,\n                        quantity: 2,\n                        variant_id: variant,\n                    })\n                    .then(updatedCart => {\n                        log('Add to cart', updatedCart);\n\n                        window.cart = updatedCart;\n\n                        if (checkout) {\n                            updatedCart.checkout();\n                        }\n                    })\n                    .catch(error => fail('Add to cart', error));\n            })\n            .catch(error => fail('Get cart', error));\n    }\n\n    const products = {\n        GBP: 'http://selz.co/1MaSYRU',\n        USD: 'http://selz.co/1rvbhT6',\n    };\n\n    client\n        .getProduct(products.USD)\n        .then(product => {\n            log('Product', product);\n\n            // Expose\n            window.product = product;\n\n            addToCart(product, true);\n\n            // product.buy();\n\n            // product.view();\n        })\n        .catch(errors => fail('Product', errors));\n\n    // Listen for messages from parent\n    window.addEventListener('message', event => {\n        // console.warn(event.data);\n        const json = JSON.parse(event.data);\n\n        if (json.key !== 'add-to-cart') {\n            return;\n        }\n\n        addToCart(json.data);\n    });\n});\n"],"names":["document","addEventListener","output","getElementById","log","label","data","details","createElement","summary","innerHTML","appendChild","contents","pre","classList","add","JSON","stringify","prettyPrint","fail","errors","Error","error","toString","client","SelzClient","buttons","background","text","checkout","addToCart","product","currency","currency_code","Promise","resolve","reject","window","cart","getCart","then","catch","variant","length","variants","id","updatedCart","config","getProduct","json","parse","event","key"],"mappings":"AAAAA,SAASC,iBAAiB,mBAAoB,eACpCC,EAASF,SAASG,eAAe,mBAE9BC,EAAIC,EAAOC,OACVC,EAAUP,SAASQ,cAAc,WAEjCC,EAAUT,SAASQ,cAAc,aAC/BE,UAAYL,IACZM,YAAYF,OAEdG,EAAWZ,SAASQ,cAAc,OAClCK,EAAMb,SAASQ,cAAc,SAC/BM,UAAUC,IAAI,iBACdL,UAAYM,KAAKC,UAAUX,EAAM,KAAM,KAClCK,YAAYE,KACbF,YAAYC,KAEbD,YAAYJ,UAEZW,uBAGFC,EAAKd,EAAOe,UACbA,aAAkBC,eACVC,MAAMF,GACPhB,EAAOC,cAAmBiB,MAAOF,EAAOG,cAG5CnB,EAAOC,cAAkBe,OAG9BI,EAAS,IAAIC,eACX,OAEC,gBACKC,SAAWC,WAAY,UAAWC,KAAM,WAAaC,UAAYF,WAAY,UAAWC,KAAM,uBA+BnGE,EAAUC,OApBFC,EAoBWH,2DApBXG,EAqBLD,EAAQE,cApBT,IAAIC,QAAQ,SAACC,EAASC,GACrBC,OAAOC,OACCD,OAAOC,QAKdC,QAAQP,GACRQ,KAAK,cACE,WAAYF,UAETA,KAAOA,IAENA,KAEXG,MAAM,mBAASL,EAAOd,QAM1BkB,KAAK,gBACEE,EAAU,KAEiB,iBAApBX,EAAQW,SAAwBX,EAAQW,QAAQC,SAC7CZ,EAAQW,QACXX,EAAQa,UAAYb,EAAQa,SAASD,WAClCZ,EAAQa,SAAS,GAAGC,MAI7B9B,QACOgB,EAAQc,YACF,aACEH,IAEfF,KAAK,cACE,cAAeM,UAEZR,KAAOQ,EAEVjB,KACYA,aAGnBY,MAAM,mBAAStB,EAAK,cAAeG,OAE3CmB,MAAM,mBAAStB,EAAK,WAAYG,YAvDlCE,OAASA,IAEZ,SAAUA,EAAOuB,UA8DhBC,WAJI,0BAKJR,KAAK,cACE,UAAWT,UAGRA,QAAUA,IAEPA,GAAS,KAMtBU,MAAM,mBAAUtB,EAAK,UAAWC,YAG9BnB,iBAAiB,UAAW,gBAEzBgD,EAAOjC,KAAKkC,MAAMC,EAAM7C,MAEb,gBAAb2C,EAAKG,OAICH,EAAK3C"}